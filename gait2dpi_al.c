// This file contains C code generated by Autolev

#include <math.h>
#include "gait2dpi.h"
void gait2dpi(param_struct* par, double q[NDOF], double qd[NDOF], double qdd[NDOF],
   double Vsurface[2], double QQ[NDOF], double dQQ_dq[NDOF*NDOF],
   double dQQ_dqd[NDOF*NDOF], double dQQ_dqdd[NDOF*NDOF],
   double grf[6], double stick[NSTICK*2]) {
   
// Inputs:   
//	par.........Struct with model parameters, see gait2dp.h for details.   
//	q,qd,qdd....Generalized coordinates, velocities, accelerations   
//	Vsurface....Surface velocity, Left and Right are separate for specificate situations.   
//   
// Outputs:   
//    QQ...........Joint moments required to produce accelerations qdd at state q,qd
//    dQQdq, dQQdqd, dQQdqdd..... Jacobians of QQ with respect to q,qd,qdd   
//    GRF.........Fx,Fy,Mz on right foot, Fx,Fy,Mz on left foot   
//    stick.......X and Y coordinates of 10 points: trunkCM, hip, Rknee, Rankle, Rheel, Rtoe, Lknee, Lankle, Lheel, Ltoe
   
	double q1   = q[0];  
	double q1p  = qd[0]; 
	double q1pp = qdd[0];
	double q2   = q[1];  
	double q2p  = qd[1]; 
	double q2pp = qdd[1];
	double q3   = q[2];  
	double q3p  = qd[2]; 
	double q3pp = qdd[2];
	double q4   = q[3];  
	double q4p  = qd[3]; 
	double q4pp = qdd[3];
	double q5   = q[4];  
	double q5p  = qd[4]; 
	double q5pp = qdd[4];
	double q6   = q[5];  
	double q6p  = qd[5]; 
	double q6pp = qdd[5];
	double q7   = q[6];  
	double q7p  = qd[6]; 
	double q7pp = qdd[6];
	double q8   = q[7];  
	double q8p  = qd[7]; 
	double q8pp = qdd[7];
	double q9   = q[8];  
	double q9p  = qd[8]; 
	double q9pp = qdd[8];
	double VsurfaceR = Vsurface[0];
	double VsurfaceL = Vsurface[1];
	double yRHeel;
	double dRHeel;
	double ydotRHeel;
	double xdotRHeel;
	double FxRHeel;
	double FyRHeel;
	double yRToe;
	double dRToe;
	double ydotRToe;
	double xdotRToe;
	double FxRToe;
	double FyRToe;
	double yLHeel;
	double dLHeel;
	double ydotLHeel;
	double xdotLHeel;
	double FxLHeel;
	double FyLHeel;
	double yLToe;
	double dLToe;
	double ydotLToe;
	double xdotLToe;
	double FxLToe;
	double FyLToe;
	static double z[583];
  z[1] = cos(q3);
  z[2] = sin(q3);
  z[3] = par->TrunkCMy*q3p;
  z[4] = q3p*z[3];
  z[5] = cos(q4);
  z[6] = sin(q4);
  z[7] = z[1]*z[5] - z[2]*z[6];
  z[8] = -z[1]*z[6] - z[2]*z[5];
  z[9] = z[1]*z[6] + z[2]*z[5];
  z[10] = par->ThighCMy*(q3p+q4p);
  z[11] = q3p + q4p;
  z[12] = z[10]*z[11];
  z[13] = cos(q5);
  z[14] = sin(q5);
  z[15] = par->ThighLen*(q3p+q4p);
  z[16] = z[11]*z[15];
  z[17] = z[7]*z[13] + z[8]*z[14];
  z[18] = z[8]*z[13] - z[7]*z[14];
  z[19] = z[7]*z[14] + z[9]*z[13];
  z[20] = z[7]*z[13] - z[9]*z[14];
  z[21] = par->ThighLen*z[13];
  z[22] = par->ThighLen*z[14];
  z[23] = z[21] - par->ShankCMy;
  z[24] = z[14]*z[16];
  z[25] = z[13]*z[16];
  z[26] = par->ShankCMy*(q3p+q4p+q5p);
  z[27] = q3p + q4p + q5p;
  z[28] = z[25] - z[26]*z[27];
  z[29] = cos(q6);
  z[30] = sin(q6);
  z[31] = par->ShankLen + z[21];
  z[32] = par->ShankLen*(q3p+q4p+q5p);
  z[33] = z[25] + z[27]*z[32];
  z[34] = z[17]*z[29] + z[18]*z[30];
  z[35] = z[18]*z[29] - z[17]*z[30];
  z[36] = z[19]*z[29] + z[20]*z[30];
  z[37] = z[20]*z[29] - z[19]*z[30];
  z[38] = par->ShankLen*z[29];
  z[39] = z[29]*z[31] - z[22]*z[30];
  z[40] = -z[22]*z[29] - z[30]*z[31];
  z[41] = par->ShankLen*z[30];
  z[42] = z[38] - par->FootCMy;
  z[43] = z[39] - par->FootCMy;
  z[44] = par->FootCMx + z[40];
  z[45] = par->FootCMx - z[41];
  z[46] = z[29]*z[24] + z[30]*z[33];
  z[47] = z[29]*z[33] - z[30]*z[24];
  z[48] = par->FootCMx*(q3p+q4p+q5p+q6p);
  z[49] = par->FootCMy*(q3p+q4p+q5p+q6p);
  z[50] = q3p + q4p + q5p + q6p;
  z[51] = z[46] - z[48]*z[50];
  z[52] = z[47] - z[49]*z[50];
  z[53] = cos(q7);
  z[54] = sin(q7);
  z[55] = z[1]*z[53] - z[2]*z[54];
  z[56] = -z[1]*z[54] - z[2]*z[53];
  z[57] = z[1]*z[54] + z[2]*z[53];
  z[58] = par->ThighCMy*(q3p+q7p);
  z[59] = q3p + q7p;
  z[60] = z[58]*z[59];
  z[61] = cos(q8);
  z[62] = sin(q8);
  z[63] = par->ThighLen*(q3p+q7p);
  z[64] = z[59]*z[63];
  z[65] = z[55]*z[61] + z[56]*z[62];
  z[66] = z[56]*z[61] - z[55]*z[62];
  z[67] = z[55]*z[62] + z[57]*z[61];
  z[68] = z[55]*z[61] - z[57]*z[62];
  z[69] = par->ThighLen*z[61];
  z[70] = par->ThighLen*z[62];
  z[71] = z[69] - par->ShankCMy;
  z[72] = z[62]*z[64];
  z[73] = z[61]*z[64];
  z[74] = par->ShankCMy*(q3p+q7p+q8p);
  z[75] = q3p + q7p + q8p;
  z[76] = z[73] - z[74]*z[75];
  z[77] = cos(q9);
  z[78] = sin(q9);
  z[79] = par->ShankLen + z[69];
  z[80] = par->ShankLen*(q3p+q7p+q8p);
  z[81] = z[73] + z[75]*z[80];
  z[82] = z[65]*z[77] + z[66]*z[78];
  z[83] = z[66]*z[77] - z[65]*z[78];
  z[84] = z[67]*z[77] + z[68]*z[78];
  z[85] = z[68]*z[77] - z[67]*z[78];
  z[86] = par->ShankLen*z[77];
  z[87] = z[77]*z[79] - z[70]*z[78];
  z[88] = -z[70]*z[77] - z[78]*z[79];
  z[89] = par->ShankLen*z[78];
  z[90] = z[86] - par->FootCMy;
  z[91] = z[87] - par->FootCMy;
  z[92] = par->FootCMx + z[88];
  z[93] = par->FootCMx - z[89];
  z[94] = z[77]*z[72] + z[78]*z[81];
  z[95] = z[77]*z[81] - z[78]*z[72];
  z[96] = par->FootCMx*(q3p+q7p+q8p+q9p);
  z[97] = par->FootCMy*(q3p+q7p+q8p+q9p);
  z[98] = q3p + q7p + q8p + q9p;
  z[99] = z[94] - z[96]*z[98];
  z[100] = z[95] - z[97]*z[98];
  z[101] = par->FootMass*par->gravity;
  z[102] = par->gravity*par->ShankMass;
  z[103] = par->gravity*par->ThighMass;
  z[104] = par->gravity*par->TrunkMass;
  z[105] = z[38] - par->ContactY;
  z[106] = z[39] - par->ContactY;
  z[107] = par->ContactHeelX + z[40];
  z[108] = par->ContactHeelX - z[41];
  z[109] = par->ContactToeX + z[40];
  z[110] = par->ContactToeX - z[41];
  z[111] = z[86] - par->ContactY;
  z[112] = z[87] - par->ContactY;
  z[113] = par->ContactHeelX + z[88];
  z[114] = par->ContactHeelX - z[89];
  z[115] = par->ContactToeX + z[88];
  z[116] = par->ContactToeX - z[89];
  yRHeel = q2 + par->ContactHeelX*z[36] + par->ContactY*z[37] - par->ShankLen*
  z[20] - par->ThighLen*z[7];
  dRHeel = 0.5*fabs(yRHeel) - 0.5*yRHeel;
  xdotRHeel = z[35]*(par->ContactHeelX*q6p+z[35]*q1p+z[37]*q2p+z[107]*q3p+
  z[107]*q4p+z[108]*q5p) - z[34]*(par->ContactY*q6p-z[34]*q1p-z[36]*q2p-
  z[105]*q5p-z[106]*q3p-z[106]*q4p);
  ydotRHeel = z[37]*(par->ContactHeelX*q6p+z[35]*q1p+z[37]*q2p+z[107]*q3p+
  z[107]*q4p+z[108]*q5p) - z[36]*(par->ContactY*q6p-z[34]*q1p-z[36]*q2p-
  z[105]*q5p-z[106]*q3p-z[106]*q4p);
  FyRHeel = -(yRHeel-par->ContactStiff*pow(dRHeel,3))*(1-par->ContactDamp*
  ydotRHeel);
  FxRHeel = -par->ContactFric*FyRHeel*(-1+2/(1+exp((VsurfaceR-xdotRHeel)/
  par->ContactV0)));
  yRToe = q2 + par->ContactToeX*z[36] + par->ContactY*z[37] - par->ShankLen*
  z[20] - par->ThighLen*z[7];
  dRToe = 0.5*fabs(yRToe) - 0.5*yRToe;
  xdotRToe = z[35]*(par->ContactToeX*q6p+z[35]*q1p+z[37]*q2p+z[109]*q3p+
  z[109]*q4p+z[110]*q5p) - z[34]*(par->ContactY*q6p-z[34]*q1p-z[36]*q2p-
  z[105]*q5p-z[106]*q3p-z[106]*q4p);
  ydotRToe = z[37]*(par->ContactToeX*q6p+z[35]*q1p+z[37]*q2p+z[109]*q3p+
  z[109]*q4p+z[110]*q5p) - z[36]*(par->ContactY*q6p-z[34]*q1p-z[36]*q2p-
  z[105]*q5p-z[106]*q3p-z[106]*q4p);
  FyRToe = -(yRToe-par->ContactStiff*pow(dRToe,3))*(1-par->ContactDamp*ydotRToe);
  FxRToe = -par->ContactFric*FyRToe*(-1+2/(1+exp((VsurfaceR-xdotRToe)/par->ContactV0)));
  yLHeel = q2 + par->ContactHeelX*z[84] + par->ContactY*z[85] - par->ShankLen*
  z[68] - par->ThighLen*z[55];
  dLHeel = 0.5*fabs(yLHeel) - 0.5*yLHeel;
  xdotLHeel = z[83]*(par->ContactHeelX*q9p+z[83]*q1p+z[85]*q2p+z[113]*q3p+
  z[113]*q7p+z[114]*q8p) - z[82]*(par->ContactY*q9p-z[82]*q1p-z[84]*q2p-
  z[111]*q8p-z[112]*q3p-z[112]*q7p);
  ydotLHeel = z[85]*(par->ContactHeelX*q9p+z[83]*q1p+z[85]*q2p+z[113]*q3p+
  z[113]*q7p+z[114]*q8p) - z[84]*(par->ContactY*q9p-z[82]*q1p-z[84]*q2p-
  z[111]*q8p-z[112]*q3p-z[112]*q7p);
  FyLHeel = -(yLHeel-par->ContactStiff*pow(dLHeel,3))*(1-par->ContactDamp*
  ydotLHeel);
  FxLHeel = -par->ContactFric*FyLHeel*(-1+2/(1+exp((VsurfaceL-xdotLHeel)/
  par->ContactV0)));
  yLToe = q2 + par->ContactToeX*z[84] + par->ContactY*z[85] - par->ShankLen*
  z[68] - par->ThighLen*z[55];
  dLToe = 0.5*fabs(yLToe) - 0.5*yLToe;
  xdotLToe = z[83]*(par->ContactToeX*q9p+z[83]*q1p+z[85]*q2p+z[115]*q3p+
  z[115]*q7p+z[116]*q8p) - z[82]*(par->ContactY*q9p-z[82]*q1p-z[84]*q2p-
  z[111]*q8p-z[112]*q3p-z[112]*q7p);
  ydotLToe = z[85]*(par->ContactToeX*q9p+z[83]*q1p+z[85]*q2p+z[115]*q3p+
  z[115]*q7p+z[116]*q8p) - z[84]*(par->ContactY*q9p-z[82]*q1p-z[84]*q2p-
  z[111]*q8p-z[112]*q3p-z[112]*q7p);
  FyLToe = -(yLToe-par->ContactStiff*pow(dLToe,3))*(1-par->ContactDamp*ydotLToe);
  FxLToe = -par->ContactFric*FyLToe*(-1+2/(1+exp((VsurfaceL-xdotLToe)/par->ContactV0)));
  z[117] = z[34]*z[36]*FyRHeel + z[34]*z[36]*FyRToe + pow(z[34],2)*FxRHeel + 
  pow(z[34],2)*FxRToe + z[35]*z[37]*FyRHeel + z[35]*z[37]*FyRToe + pow(z[35],
  2)*FxRHeel + pow(z[35],2)*FxRToe + z[82]*z[84]*FyLHeel + z[82]*z[84]*FyLToe + 
  pow(z[82],2)*FxLHeel + pow(z[82],2)*FxLToe + z[83]*z[85]*FyLHeel + z[83]*
  z[85]*FyLToe + pow(z[83],2)*FxLHeel + pow(z[83],2)*FxLToe - z[7]*z[103]*(
  z[8]+z[9]) - z[55]*z[103]*(z[56]+z[57]) - z[101]*(z[34]*z[36]+z[35]*z[37]) - 
  z[101]*(z[82]*z[84]+z[83]*z[85]) - z[102]*(z[17]*z[19]+z[18]*z[20]) - 
  z[102]*(z[65]*z[67]+z[66]*z[68]);
  z[118] = z[34]*z[36]*FxRHeel + z[34]*z[36]*FxRToe + z[35]*z[37]*FxRHeel + 
  z[35]*z[37]*FxRToe + pow(z[36],2)*FyRHeel + pow(z[36],2)*FyRToe + pow(z[37],
  2)*FyRHeel + pow(z[37],2)*FyRToe + z[82]*z[84]*FxLHeel + z[82]*z[84]*FxLToe + 
  z[83]*z[85]*FxLHeel + z[83]*z[85]*FxLToe + pow(z[84],2)*FyLHeel + pow(z[84],
  2)*FyLToe + pow(z[85],2)*FyLHeel + pow(z[85],2)*FyLToe - z[101]*(pow(z[36],
  2)+pow(z[37],2)) - z[101]*(pow(z[84],2)+pow(z[85],2)) - z[102]*(pow(z[19],2)+
  pow(z[20],2)) - z[102]*(pow(z[67],2)+pow(z[68],2)) - z[103]*(pow(z[7],2)+
  pow(z[9],2)) - z[103]*(pow(z[55],2)+pow(z[57],2)) - z[104]*(pow(z[1],2)+
  pow(z[2],2));
  z[119] = par->ThighCMy*z[9]*z[103] + par->ThighCMy*z[57]*z[103] + par->TrunkCMy*
  z[2]*z[104] + z[34]*z[106]*FxRHeel + z[34]*z[106]*FxRToe + z[35]*z[107]*
  FxRHeel + z[35]*z[109]*FxRToe + z[36]*z[106]*FyRHeel + z[36]*z[106]*FyRToe + 
  z[37]*z[107]*FyRHeel + z[37]*z[109]*FyRToe + z[82]*z[112]*FxLHeel + z[82]*
  z[112]*FxLToe + z[83]*z[113]*FxLHeel + z[83]*z[115]*FxLToe + z[84]*z[112]*
  FyLHeel + z[84]*z[112]*FyLToe + z[85]*z[113]*FyLHeel + z[85]*z[115]*FyLToe - 
  z[101]*(z[36]*z[43]+z[37]*z[44]) - z[101]*(z[84]*z[91]+z[85]*z[92]) - 
  z[102]*(z[19]*z[23]-z[20]*z[22]) - z[102]*(z[67]*z[71]-z[68]*z[70]);
  z[120] = par->ThighCMy*z[9]*z[103] + z[34]*z[106]*FxRHeel + z[34]*z[106]*
  FxRToe + z[35]*z[107]*FxRHeel + z[35]*z[109]*FxRToe + z[36]*z[106]*FyRHeel + 
  z[36]*z[106]*FyRToe + z[37]*z[107]*FyRHeel + z[37]*z[109]*FyRToe - z[101]*(
  z[36]*z[43]+z[37]*z[44]) - z[102]*(z[19]*z[23]-z[20]*z[22]);
  z[121] = par->ShankCMy*z[19]*z[102] + z[34]*z[105]*FxRHeel + z[34]*z[105]*
  FxRToe + z[35]*z[108]*FxRHeel + z[35]*z[110]*FxRToe + z[36]*z[105]*FyRHeel + 
  z[36]*z[105]*FyRToe + z[37]*z[108]*FyRHeel + z[37]*z[110]*FyRToe - z[101]*(
  z[36]*z[42]+z[37]*z[45]);
  z[122] = par->ContactHeelX*z[35]*FxRHeel + par->ContactHeelX*z[37]*FyRHeel + 
  par->ContactToeX*z[35]*FxRToe + par->ContactToeX*z[37]*FyRToe - z[101]*(
  par->FootCMx*z[37]-par->FootCMy*z[36]) - par->ContactY*z[34]*FxRHeel - 
  par->ContactY*z[34]*FxRToe - par->ContactY*z[36]*FyRHeel - par->ContactY*
  z[36]*FyRToe;
  z[123] = par->ThighCMy*z[57]*z[103] + z[82]*z[112]*FxLHeel + z[82]*z[112]*
  FxLToe + z[83]*z[113]*FxLHeel + z[83]*z[115]*FxLToe + z[84]*z[112]*FyLHeel + 
  z[84]*z[112]*FyLToe + z[85]*z[113]*FyLHeel + z[85]*z[115]*FyLToe - z[101]*(
  z[84]*z[91]+z[85]*z[92]) - z[102]*(z[67]*z[71]-z[68]*z[70]);
  z[124] = par->ShankCMy*z[67]*z[102] + z[82]*z[111]*FxLHeel + z[82]*z[111]*
  FxLToe + z[83]*z[114]*FxLHeel + z[83]*z[116]*FxLToe + z[84]*z[111]*FyLHeel + 
  z[84]*z[111]*FyLToe + z[85]*z[114]*FyLHeel + z[85]*z[116]*FyLToe - z[101]*(
  z[84]*z[90]+z[85]*z[93]);
  z[125] = par->ContactHeelX*z[83]*FxLHeel + par->ContactHeelX*z[85]*FyLHeel + 
  par->ContactToeX*z[83]*FxLToe + par->ContactToeX*z[85]*FyLToe - z[101]*(
  par->FootCMx*z[85]-par->FootCMy*z[84]) - par->ContactY*z[82]*FxLHeel - 
  par->ContactY*z[82]*FxLToe - par->ContactY*z[84]*FyLHeel - par->ContactY*
  z[84]*FyLToe;
  z[126] = par->FootMass*(par->FootCMx*z[83]-par->FootCMy*z[82]);
  z[127] = par->FootMass*(pow(z[34],2)+pow(z[35],2)) + par->FootMass*(pow(
  z[82],2)+pow(z[83],2)) + par->ShankMass*(pow(z[17],2)+pow(z[18],2)) + 
  par->ShankMass*(pow(z[65],2)+pow(z[66],2)) + par->ThighMass*(pow(z[7],2)+
  pow(z[8],2)) + par->ThighMass*(pow(z[55],2)+pow(z[56],2)) + par->TrunkMass*(
  pow(z[1],2)+pow(z[2],2));
  z[128] = par->ThighMass*z[7]*(z[8]+z[9]) + par->ThighMass*z[55]*(z[56]+
  z[57]) + par->FootMass*(z[34]*z[36]+z[35]*z[37]) + par->FootMass*(z[82]*
  z[84]+z[83]*z[85]) + par->ShankMass*(z[17]*z[19]+z[18]*z[20]) + par->ShankMass*(
  z[65]*z[67]+z[66]*z[68]);
  z[129] = par->FootMass*(z[34]*z[43]+z[35]*z[44]) + par->FootMass*(z[82]*
  z[91]+z[83]*z[92]) + par->ShankMass*(z[17]*z[23]-z[18]*z[22]) + par->ShankMass*(
  z[65]*z[71]-z[66]*z[70]) - par->ThighCMy*par->ThighMass*z[7] - par->ThighCMy*
  par->ThighMass*z[55] - par->TrunkCMy*par->TrunkMass*z[1];
  z[130] = par->FootMass*(z[82]*z[91]+z[83]*z[92]) + par->ShankMass*(z[65]*
  z[71]-z[66]*z[70]) - par->ThighCMy*par->ThighMass*z[55];
  z[131] = par->FootMass*(z[82]*z[90]+z[83]*z[93]) - par->ShankCMy*par->ShankMass*
  z[65];
  z[132] = par->FootMass*(par->FootCMx*z[35]-par->FootCMy*z[34]);
  z[133] = par->FootMass*(z[34]*z[43]+z[35]*z[44]) + par->ShankMass*(z[17]*
  z[23]-z[18]*z[22]) - par->ThighCMy*par->ThighMass*z[7];
  z[134] = par->FootMass*(z[34]*z[42]+z[35]*z[45]) - par->ShankCMy*par->ShankMass*
  z[17];
  z[135] = par->TrunkMass*z[2]*z[4] + par->FootMass*(z[34]*z[51]+z[35]*z[52]) + 
  par->FootMass*(z[82]*z[99]+z[83]*z[100]) + par->ShankMass*(z[17]*z[24]+
  z[18]*z[28]) + par->ShankMass*(z[65]*z[72]+z[66]*z[76]) - par->ThighMass*
  z[8]*z[12] - par->ThighMass*z[56]*z[60];
  z[136] = par->FootMass*(par->FootCMx*z[85]-par->FootCMy*z[84]);
  z[137] = par->FootMass*(pow(z[36],2)+pow(z[37],2)) + par->FootMass*(pow(
  z[84],2)+pow(z[85],2)) + par->ShankMass*(pow(z[19],2)+pow(z[20],2)) + 
  par->ShankMass*(pow(z[67],2)+pow(z[68],2)) + par->ThighMass*(pow(z[7],2)+
  pow(z[9],2)) + par->ThighMass*(pow(z[55],2)+pow(z[57],2)) + par->TrunkMass*(
  pow(z[1],2)+pow(z[2],2));
  z[138] = par->FootMass*(z[36]*z[43]+z[37]*z[44]) + par->FootMass*(z[84]*
  z[91]+z[85]*z[92]) + par->ShankMass*(z[19]*z[23]-z[20]*z[22]) + par->ShankMass*(
  z[67]*z[71]-z[68]*z[70]) - par->ThighCMy*par->ThighMass*z[9] - par->ThighCMy*
  par->ThighMass*z[57] - par->TrunkCMy*par->TrunkMass*z[2];
  z[139] = par->FootMass*(z[84]*z[91]+z[85]*z[92]) + par->ShankMass*(z[67]*
  z[71]-z[68]*z[70]) - par->ThighCMy*par->ThighMass*z[57];
  z[140] = par->FootMass*(z[84]*z[90]+z[85]*z[93]) - par->ShankCMy*par->ShankMass*
  z[67];
  z[141] = par->FootMass*(par->FootCMx*z[37]-par->FootCMy*z[36]);
  z[142] = par->FootMass*(z[36]*z[43]+z[37]*z[44]) + par->ShankMass*(z[19]*
  z[23]-z[20]*z[22]) - par->ThighCMy*par->ThighMass*z[9];
  z[143] = par->FootMass*(z[36]*z[42]+z[37]*z[45]) - par->ShankCMy*par->ShankMass*
  z[19];
  z[144] = par->FootMass*(z[36]*z[51]+z[37]*z[52]) + par->FootMass*(z[84]*
  z[99]+z[85]*z[100]) + par->ShankMass*(z[19]*z[24]+z[20]*z[28]) + par->ShankMass*(
  z[67]*z[72]+z[68]*z[76]) - par->ThighMass*z[7]*z[12] - par->ThighMass*z[55]*
  z[60] - par->TrunkMass*z[1]*z[4];
  z[145] = par->TrunkInertia + 2*par->FootInertia + 2*par->ShankInertia + 2*
  par->ThighInertia + par->TrunkMass*pow(par->TrunkCMy,2) + 2*par->ThighMass*
  pow(par->ThighCMy,2) + par->FootMass*(pow(z[43],2)+pow(z[44],2)) + par->FootMass*(
  pow(z[91],2)+pow(z[92],2)) + par->ShankMass*(pow(z[22],2)+pow(z[23],2)) + 
  par->ShankMass*(pow(z[70],2)+pow(z[71],2));
  z[146] = par->FootInertia + par->ShankInertia + par->ThighInertia + par->ThighMass*
  pow(par->ThighCMy,2) + par->FootMass*(pow(z[91],2)+pow(z[92],2)) + par->ShankMass*(
  pow(z[70],2)+pow(z[71],2));
  z[147] = par->FootInertia + par->ShankInertia + par->FootMass*(z[90]*z[91]+
  z[92]*z[93]) - par->ShankCMy*par->ShankMass*z[71];
  z[148] = par->FootInertia + par->FootMass*(par->FootCMx*z[92]-par->FootCMy*
  z[91]);
  z[149] = par->FootInertia + par->ShankInertia + par->ThighInertia + par->ThighMass*
  pow(par->ThighCMy,2) + par->FootMass*(pow(z[43],2)+pow(z[44],2)) + par->ShankMass*(
  pow(z[22],2)+pow(z[23],2));
  z[150] = par->FootInertia + par->ShankInertia + par->FootMass*(z[42]*z[43]+
  z[44]*z[45]) - par->ShankCMy*par->ShankMass*z[23];
  z[151] = par->FootInertia + par->FootMass*(par->FootCMx*z[44]-par->FootCMy*
  z[43]);
  z[152] = par->FootMass*(z[43]*z[51]+z[44]*z[52]) + par->FootMass*(z[91]*
  z[99]+z[92]*z[100]) - par->ShankMass*(z[22]*z[28]-z[23]*z[24]) - par->ShankMass*(
  z[70]*z[76]-z[71]*z[72]);
  z[153] = par->FootMass*(z[43]*z[51]+z[44]*z[52]) - par->ShankMass*(z[22]*
  z[28]-z[23]*z[24]);
  z[154] = par->FootInertia + par->ShankInertia + par->ShankMass*pow(par->ShankCMy,
  2) + par->FootMass*(pow(z[42],2)+pow(z[45],2));
  z[155] = par->FootInertia + par->FootMass*(par->FootCMx*z[45]-par->FootCMy*
  z[42]);
  z[156] = par->FootMass*(z[42]*z[51]+z[45]*z[52]) - par->ShankCMy*par->ShankMass*
  z[24];
  z[157] = par->FootInertia + par->FootMass*(pow(par->FootCMx,2)+pow(par->FootCMy,
  2));
  z[158] = par->FootMass*(par->FootCMx*z[52]-par->FootCMy*z[51]);
  z[159] = par->FootMass*(z[91]*z[99]+z[92]*z[100]) - par->ShankMass*(z[70]*
  z[76]-z[71]*z[72]);
  z[160] = par->FootInertia + par->ShankInertia + par->ShankMass*pow(par->ShankCMy,
  2) + par->FootMass*(pow(z[90],2)+pow(z[93],2));
  z[161] = par->FootInertia + par->FootMass*(par->FootCMx*z[93]-par->FootCMy*
  z[90]);
  z[162] = par->FootMass*(z[90]*z[99]+z[93]*z[100]) - par->ShankCMy*par->ShankMass*
  z[72];
  z[163] = par->FootMass*(par->FootCMx*z[100]-par->FootCMy*z[99]);
  z[164] = fabs(yRHeel);
  z[165] = (1+1.5*par->ContactStiff*pow(dRHeel,2)*(1-yRHeel/z[164]))*(1-
  par->ContactDamp*ydotRHeel);
  z[166] = fabs(yRToe);
  z[167] = (1+1.5*par->ContactStiff*pow(dRToe,2)*(1-yRToe/z[166]))*(1-par->ContactDamp*
  ydotRToe);
  z[168] = fabs(yLHeel);
  z[169] = (1+1.5*par->ContactStiff*pow(dLHeel,2)*(1-yLHeel/z[168]))*(1-
  par->ContactDamp*ydotLHeel);
  z[170] = fabs(yLToe);
  z[171] = (1+1.5*par->ContactStiff*pow(dLToe,2)*(1-yLToe/z[170]))*(1-par->ContactDamp*
  ydotLToe);
  z[172] = exp((VsurfaceR-xdotRHeel)/par->ContactV0);
  z[173] = exp((VsurfaceR-xdotRToe)/par->ContactV0);
  z[174] = exp((VsurfaceL-xdotLHeel)/par->ContactV0);
  z[175] = exp((VsurfaceL-xdotLToe)/par->ContactV0);
  z[176] = par->ContactFric*pow(z[34],2)*z[165]*(-1+2/(1+z[172])) + par->ContactFric*
  pow(z[34],2)*z[167]*(-1+2/(1+z[173])) + par->ContactFric*pow(z[35],2)*
  z[165]*(-1+2/(1+z[172])) + par->ContactFric*pow(z[35],2)*z[167]*(-1+2/(1+
  z[173])) + par->ContactFric*pow(z[82],2)*z[169]*(-1+2/(1+z[174])) + par->ContactFric*
  pow(z[82],2)*z[171]*(-1+2/(1+z[175])) + par->ContactFric*pow(z[83],2)*
  z[169]*(-1+2/(1+z[174])) + par->ContactFric*pow(z[83],2)*z[171]*(-1+2/(1+
  z[175])) - z[34]*z[36]*z[165] - z[34]*z[36]*z[167] - z[35]*z[37]*z[165] - 
  z[35]*z[37]*z[167] - z[82]*z[84]*z[169] - z[82]*z[84]*z[171] - z[83]*z[85]*
  z[169] - z[83]*z[85]*z[171];
  z[177] = z[2]*z[6] - z[1]*z[5];
  z[178] = z[8]*z[13] + z[14]*z[177];
  z[179] = z[13]*z[177] - z[8]*z[14];
  z[180] = z[29]*z[178] + z[30]*z[179];
  z[181] = z[29]*z[179] - z[30]*z[178];
  z[182] = z[2]*z[54] - z[1]*z[53];
  z[183] = z[56]*z[61] + z[62]*z[182];
  z[184] = z[61]*z[182] - z[56]*z[62];
  z[185] = z[77]*z[183] + z[78]*z[184];
  z[186] = z[77]*z[184] - z[78]*z[183];
  z[187] = par->TrunkMass*z[1]*z[4] + par->FootMass*(z[180]*z[51]+z[181]*
  z[52]) + par->FootMass*(z[185]*z[99]+z[186]*z[100]) + par->ShankMass*(
  z[178]*z[24]+z[179]*z[28]) + par->ShankMass*(z[183]*z[72]+z[184]*z[76]) - 
  par->ThighMass*z[177]*z[12] - par->ThighMass*z[182]*z[60];
  z[188] = par->FootMass*(par->FootCMx*z[186]-par->FootCMy*z[185]);
  z[189] = 2*par->ThighMass*z[8]*(z[7]+z[177]) + 2*par->ThighMass*z[56]*(
  z[55]+z[182]) + 2*par->FootMass*(z[34]*z[180]+z[35]*z[181]) + 2*par->FootMass*(
  z[82]*z[185]+z[83]*z[186]) + 2*par->ShankMass*(z[17]*z[178]+z[18]*z[179]) + 
  2*par->ShankMass*(z[65]*z[183]+z[66]*z[184]);
  z[190] = par->ThighMass*z[7]*(z[7]+z[177]) + par->ThighMass*z[8]*(z[8]+z[9]) + 
  par->ThighMass*z[55]*(z[55]+z[182]) + par->ThighMass*z[56]*(z[56]+z[57]) + 
  par->FootMass*(pow(z[34],2)+pow(z[35],2)+z[36]*z[180]+z[37]*z[181]) + 
  par->FootMass*(pow(z[82],2)+pow(z[83],2)+z[84]*z[185]+z[85]*z[186]) + 
  par->ShankMass*(pow(z[17],2)+pow(z[18],2)+z[19]*z[178]+z[20]*z[179]) + 
  par->ShankMass*(pow(z[65],2)+pow(z[66],2)+z[67]*z[183]+z[68]*z[184]);
  z[191] = par->TrunkCMy*par->TrunkMass*z[2] + par->FootMass*(z[43]*z[180]+
  z[44]*z[181]) + par->FootMass*(z[91]*z[185]+z[92]*z[186]) - par->ThighCMy*
  par->ThighMass*z[8] - par->ThighCMy*par->ThighMass*z[56] - par->ShankMass*(
  z[22]*z[179]-z[23]*z[178]) - par->ShankMass*(z[70]*z[184]-z[71]*z[183]);
  z[192] = par->FootMass*(z[91]*z[185]+z[92]*z[186]) - par->ThighCMy*par->ThighMass*
  z[56] - par->ShankMass*(z[70]*z[184]-z[71]*z[183]);
  z[193] = par->FootMass*(z[90]*z[185]+z[93]*z[186]) - par->ShankCMy*par->ShankMass*
  z[183];
  z[194] = par->FootMass*(par->FootCMx*z[181]-par->FootCMy*z[180]);
  z[195] = par->FootMass*(z[43]*z[180]+z[44]*z[181]) - par->ThighCMy*par->ThighMass*
  z[8] - par->ShankMass*(z[22]*z[179]-z[23]*z[178]);
  z[196] = par->FootMass*(z[42]*z[180]+z[45]*z[181]) - par->ShankCMy*par->ShankMass*
  z[178];
  z[197] = par->ContactHeelX*z[34] + par->ContactY*z[35] - par->ShankLen*
  z[18] - par->ThighLen*z[8];
  z[198] = z[36]*(z[180]*q1p+2*z[34]*q2p) + z[37]*(z[181]*q1p+2*z[35]*q2p) + 
  z[35]*(par->ContactHeelX*q6p+z[35]*q1p+z[107]*q3p+z[107]*q4p+z[108]*q5p) - 
  z[34]*(par->ContactY*q6p-z[34]*q1p-z[105]*q5p-z[106]*q3p-z[106]*q4p);
  z[199] = par->ContactDamp*(yRHeel-par->ContactStiff*pow(dRHeel,3))*z[198] - 
  z[197]*(1+1.5*par->ContactStiff*pow(dRHeel,2)*(1-yRHeel/z[164]))*(1-par->ContactDamp*
  ydotRHeel);
  z[200] = par->ContactToeX*z[34] + par->ContactY*z[35] - par->ShankLen*z[18] - 
  par->ThighLen*z[8];
  z[201] = z[36]*(z[180]*q1p+2*z[34]*q2p) + z[37]*(z[181]*q1p+2*z[35]*q2p) + 
  z[35]*(par->ContactToeX*q6p+z[35]*q1p+z[109]*q3p+z[109]*q4p+z[110]*q5p) - 
  z[34]*(par->ContactY*q6p-z[34]*q1p-z[105]*q5p-z[106]*q3p-z[106]*q4p);
  z[202] = par->ContactDamp*(yRToe-par->ContactStiff*pow(dRToe,3))*z[201] - 
  z[200]*(1+1.5*par->ContactStiff*pow(dRToe,2)*(1-yRToe/z[166]))*(1-par->ContactDamp*
  ydotRToe);
  z[203] = z[34]*(z[34]*q2p+2*z[180]*q1p) + z[35]*(z[35]*q2p+2*z[181]*q1p) + 
  z[181]*(par->ContactHeelX*q6p+z[37]*q2p+z[107]*q3p+z[107]*q4p+z[108]*q5p) - 
  z[180]*(par->ContactY*q6p-z[36]*q2p-z[105]*q5p-z[106]*q3p-z[106]*q4p);
  z[204] = par->ContactFric*(z[199]*(-1+2/(1+z[172]))+2*FyRHeel*z[172]*z[203]/(
  par->ContactV0*pow((1+z[172]),2)));
  z[205] = z[34]*(z[34]*q2p+2*z[180]*q1p) + z[35]*(z[35]*q2p+2*z[181]*q1p) + 
  z[181]*(par->ContactToeX*q6p+z[37]*q2p+z[109]*q3p+z[109]*q4p+z[110]*q5p) - 
  z[180]*(par->ContactY*q6p-z[36]*q2p-z[105]*q5p-z[106]*q3p-z[106]*q4p);
  z[206] = par->ContactFric*(z[202]*(-1+2/(1+z[173]))+2*FyRToe*z[173]*z[205]/(
  par->ContactV0*pow((1+z[173]),2)));
  z[207] = par->ContactHeelX*z[82] + par->ContactY*z[83] - par->ShankLen*
  z[66] - par->ThighLen*z[56];
  z[208] = z[84]*(z[185]*q1p+2*z[82]*q2p) + z[85]*(z[186]*q1p+2*z[83]*q2p) + 
  z[83]*(par->ContactHeelX*q9p+z[83]*q1p+z[113]*q3p+z[113]*q7p+z[114]*q8p) - 
  z[82]*(par->ContactY*q9p-z[82]*q1p-z[111]*q8p-z[112]*q3p-z[112]*q7p);
  z[209] = par->ContactDamp*(yLHeel-par->ContactStiff*pow(dLHeel,3))*z[208] - 
  z[207]*(1+1.5*par->ContactStiff*pow(dLHeel,2)*(1-yLHeel/z[168]))*(1-par->ContactDamp*
  ydotLHeel);
  z[210] = par->ContactToeX*z[82] + par->ContactY*z[83] - par->ShankLen*z[66] - 
  par->ThighLen*z[56];
  z[211] = z[84]*(z[185]*q1p+2*z[82]*q2p) + z[85]*(z[186]*q1p+2*z[83]*q2p) + 
  z[83]*(par->ContactToeX*q9p+z[83]*q1p+z[115]*q3p+z[115]*q7p+z[116]*q8p) - 
  z[82]*(par->ContactY*q9p-z[82]*q1p-z[111]*q8p-z[112]*q3p-z[112]*q7p);
  z[212] = par->ContactDamp*(yLToe-par->ContactStiff*pow(dLToe,3))*z[211] - 
  z[210]*(1+1.5*par->ContactStiff*pow(dLToe,2)*(1-yLToe/z[170]))*(1-par->ContactDamp*
  ydotLToe);
  z[213] = z[82]*(z[82]*q2p+2*z[185]*q1p) + z[83]*(z[83]*q2p+2*z[186]*q1p) + 
  z[186]*(par->ContactHeelX*q9p+z[85]*q2p+z[113]*q3p+z[113]*q7p+z[114]*q8p) - 
  z[185]*(par->ContactY*q9p-z[84]*q2p-z[111]*q8p-z[112]*q3p-z[112]*q7p);
  z[214] = par->ContactFric*(z[209]*(-1+2/(1+z[174]))+2*FyLHeel*z[174]*z[213]/(
  par->ContactV0*pow((1+z[174]),2)));
  z[215] = z[82]*(z[82]*q2p+2*z[185]*q1p) + z[83]*(z[83]*q2p+2*z[186]*q1p) + 
  z[186]*(par->ContactToeX*q9p+z[85]*q2p+z[115]*q3p+z[115]*q7p+z[116]*q8p) - 
  z[185]*(par->ContactY*q9p-z[84]*q2p-z[111]*q8p-z[112]*q3p-z[112]*q7p);
  z[216] = par->ContactFric*(z[212]*(-1+2/(1+z[175]))+2*FyLToe*z[175]*z[215]/(
  par->ContactV0*pow((1+z[175]),2)));
  z[217] = z[34]*z[36]*z[199] + z[34]*z[36]*z[202] + pow(z[34],2)*FyRHeel + 
  pow(z[34],2)*FyRToe + z[35]*z[37]*z[199] + z[35]*z[37]*z[202] + pow(z[35],2)*
  FyRHeel + pow(z[35],2)*FyRToe + z[36]*z[180]*FyRHeel + z[36]*z[180]*FyRToe + 
  z[37]*z[181]*FyRHeel + z[37]*z[181]*FyRToe + z[82]*z[84]*z[209] + z[82]*
  z[84]*z[212] + pow(z[82],2)*FyLHeel + pow(z[82],2)*FyLToe + z[83]*z[85]*
  z[209] + z[83]*z[85]*z[212] + pow(z[83],2)*FyLHeel + pow(z[83],2)*FyLToe + 
  z[84]*z[185]*FyLHeel + z[84]*z[185]*FyLToe + z[85]*z[186]*FyLHeel + z[85]*
  z[186]*FyLToe + 2*z[34]*z[180]*FxRHeel + 2*z[34]*z[180]*FxRToe + 2*z[35]*
  z[181]*FxRHeel + 2*z[35]*z[181]*FxRToe + 2*z[82]*z[185]*FxLHeel + 2*z[82]*
  z[185]*FxLToe + 2*z[83]*z[186]*FxLHeel + 2*z[83]*z[186]*FxLToe - z[7]*
  z[103]*(z[7]+z[177]) - z[8]*z[103]*(z[8]+z[9]) - z[55]*z[103]*(z[55]+z[182]) - 
  z[56]*z[103]*(z[56]+z[57]) - z[101]*(pow(z[34],2)+pow(z[35],2)+z[36]*z[180]+
  z[37]*z[181]) - z[101]*(pow(z[82],2)+pow(z[83],2)+z[84]*z[185]+z[85]*z[186]) - 
  z[102]*(pow(z[17],2)+pow(z[18],2)+z[19]*z[178]+z[20]*z[179]) - z[102]*(pow(
  z[65],2)+pow(z[66],2)+z[67]*z[183]+z[68]*z[184]) - pow(z[34],2)*z[204] - 
  pow(z[34],2)*z[206] - pow(z[35],2)*z[204] - pow(z[35],2)*z[206] - pow(z[82],
  2)*z[214] - pow(z[82],2)*z[216] - pow(z[83],2)*z[214] - pow(z[83],2)*z[216];
  z[218] = par->FootMass*(z[180]*z[51]+z[181]*z[52]) + par->ShankMass*(z[178]*
  z[24]+z[179]*z[28]) - par->ThighMass*z[177]*z[12];
  z[219] = 2*par->ThighMass*z[8]*(z[7]+z[177]) + 2*par->FootMass*(z[34]*
  z[180]+z[35]*z[181]) + 2*par->ShankMass*(z[17]*z[178]+z[18]*z[179]);
  z[220] = par->ThighMass*z[7]*(z[7]+z[177]) + par->ThighMass*z[8]*(z[8]+z[9]) + 
  par->FootMass*(pow(z[34],2)+pow(z[35],2)+z[36]*z[180]+z[37]*z[181]) + 
  par->ShankMass*(pow(z[17],2)+pow(z[18],2)+z[19]*z[178]+z[20]*z[179]);
  z[221] = z[34]*z[36]*z[199] + z[34]*z[36]*z[202] + pow(z[34],2)*FyRHeel + 
  pow(z[34],2)*FyRToe + z[35]*z[37]*z[199] + z[35]*z[37]*z[202] + pow(z[35],2)*
  FyRHeel + pow(z[35],2)*FyRToe + z[36]*z[180]*FyRHeel + z[36]*z[180]*FyRToe + 
  z[37]*z[181]*FyRHeel + z[37]*z[181]*FyRToe + 2*z[34]*z[180]*FxRHeel + 2*
  z[34]*z[180]*FxRToe + 2*z[35]*z[181]*FxRHeel + 2*z[35]*z[181]*FxRToe - z[7]*
  z[103]*(z[7]+z[177]) - z[8]*z[103]*(z[8]+z[9]) - z[101]*(pow(z[34],2)+pow(
  z[35],2)+z[36]*z[180]+z[37]*z[181]) - z[102]*(pow(z[17],2)+pow(z[18],2)+
  z[19]*z[178]+z[20]*z[179]) - pow(z[34],2)*z[204] - pow(z[34],2)*z[206] - 
  pow(z[35],2)*z[204] - pow(z[35],2)*z[206];
  z[222] = -z[7]*z[13] - z[8]*z[14];
  z[223] = z[18]*z[29] + z[30]*z[222];
  z[224] = (z[13]*z[29]-z[14]*z[30])*z[16];
  z[225] = z[29]*z[222] - z[18]*z[30];
  z[226] = (z[13]*z[30]+z[14]*z[29])*z[16];
  z[227] = par->ShankMass*(z[18]*z[24]+z[222]*z[28]+z[13]*z[17]*z[16]-z[14]*
  z[18]*z[16]) - par->FootMass*(z[35]*z[226]-z[34]*z[224]-z[223]*z[51]-z[225]*
  z[52]);
  z[228] = 2*par->ShankMass*z[18]*(z[17]+z[222]) + 2*par->FootMass*(z[34]*
  z[223]+z[35]*z[225]);
  z[229] = -z[7]*z[14] - z[9]*z[13];
  z[230] = z[20]*z[29] + z[30]*z[229];
  z[231] = z[29]*z[229] - z[20]*z[30];
  z[232] = par->FootMass*(z[34]*z[230]+z[35]*z[231]+z[36]*z[223]+z[37]*z[225]) + 
  par->ShankMass*(z[17]*z[20]+z[18]*z[19]+z[18]*z[229]+z[20]*z[222]);
  z[233] = par->ThighLen*(z[13]*z[30]+z[14]*z[29]);
  z[234] = par->ThighLen*(z[13]*z[29]-z[14]*z[30]);
  z[235] = par->ShankMass*(z[18]*z[23]-z[22]*z[222]-par->ThighLen*z[13]*z[18]-
  par->ThighLen*z[14]*z[17]) - par->FootMass*(z[34]*z[233]+z[35]*z[234]-z[43]*
  z[223]-z[44]*z[225]);
  z[236] = par->FootMass*(par->FootCMx*z[225]-par->FootCMy*z[223]);
  z[237] = par->FootMass*(z[42]*z[223]+z[45]*z[225]) - par->ShankCMy*par->ShankMass*
  z[18];
  z[238] = par->ContactHeelX*z[230] + par->ContactY*z[231] - par->ShankLen*
  z[229];
  z[239] = z[231]*(par->ContactHeelX*q6p+z[35]*q1p+z[107]*q3p+z[107]*q4p+
  z[108]*q5p) + z[36]*(z[223]*q1p+2*z[230]*q2p-z[233]*q3p-z[233]*q4p) + z[37]*(
  z[225]*q1p+2*z[231]*q2p-z[234]*q3p-z[234]*q4p) - z[230]*(par->ContactY*q6p-
  z[34]*q1p-z[105]*q5p-z[106]*q3p-z[106]*q4p);
  z[240] = par->ContactDamp*(yRHeel-par->ContactStiff*pow(dRHeel,3))*z[239] - 
  z[238]*(1+1.5*par->ContactStiff*pow(dRHeel,2)*(1-yRHeel/z[164]))*(1-par->ContactDamp*
  ydotRHeel);
  z[241] = par->ContactToeX*z[230] + par->ContactY*z[231] - par->ShankLen*
  z[229];
  z[242] = z[231]*(par->ContactToeX*q6p+z[35]*q1p+z[109]*q3p+z[109]*q4p+
  z[110]*q5p) + z[36]*(z[223]*q1p+2*z[230]*q2p-z[233]*q3p-z[233]*q4p) + z[37]*(
  z[225]*q1p+2*z[231]*q2p-z[234]*q3p-z[234]*q4p) - z[230]*(par->ContactY*q6p-
  z[34]*q1p-z[105]*q5p-z[106]*q3p-z[106]*q4p);
  z[243] = par->ContactDamp*(yRToe-par->ContactStiff*pow(dRToe,3))*z[242] - 
  z[241]*(1+1.5*par->ContactStiff*pow(dRToe,2)*(1-yRToe/z[166]))*(1-par->ContactDamp*
  ydotRToe);
  z[244] = z[225]*(par->ContactHeelX*q6p+z[37]*q2p+z[107]*q3p+z[107]*q4p+
  z[108]*q5p) + z[34]*(z[230]*q2p+2*z[223]*q1p-z[233]*q3p-z[233]*q4p) + z[35]*(
  z[231]*q2p+2*z[225]*q1p-z[234]*q3p-z[234]*q4p) - z[223]*(par->ContactY*q6p-
  z[36]*q2p-z[105]*q5p-z[106]*q3p-z[106]*q4p);
  z[245] = par->ContactFric*(z[240]*(-1+2/(1+z[172]))+2*FyRHeel*z[172]*z[244]/(
  par->ContactV0*pow((1+z[172]),2)));
  z[246] = z[225]*(par->ContactToeX*q6p+z[37]*q2p+z[109]*q3p+z[109]*q4p+
  z[110]*q5p) + z[34]*(z[230]*q2p+2*z[223]*q1p-z[233]*q3p-z[233]*q4p) + z[35]*(
  z[231]*q2p+2*z[225]*q1p-z[234]*q3p-z[234]*q4p) - z[223]*(par->ContactY*q6p-
  z[36]*q2p-z[105]*q5p-z[106]*q3p-z[106]*q4p);
  z[247] = par->ContactFric*(z[243]*(-1+2/(1+z[173]))+2*FyRToe*z[173]*z[246]/(
  par->ContactV0*pow((1+z[173]),2)));
  z[248] = z[34]*z[36]*z[240] + z[34]*z[36]*z[243] + z[34]*z[230]*FyRHeel + 
  z[34]*z[230]*FyRToe + z[35]*z[37]*z[240] + z[35]*z[37]*z[243] + z[35]*
  z[231]*FyRHeel + z[35]*z[231]*FyRToe + z[36]*z[223]*FyRHeel + z[36]*z[223]*
  FyRToe + z[37]*z[225]*FyRHeel + z[37]*z[225]*FyRToe + 2*z[34]*z[223]*FxRHeel + 
  2*z[34]*z[223]*FxRToe + 2*z[35]*z[225]*FxRHeel + 2*z[35]*z[225]*FxRToe - 
  z[101]*(z[34]*z[230]+z[35]*z[231]+z[36]*z[223]+z[37]*z[225]) - z[102]*(
  z[17]*z[20]+z[18]*z[19]+z[18]*z[229]+z[20]*z[222]) - pow(z[34],2)*z[245] - 
  pow(z[34],2)*z[247] - pow(z[35],2)*z[245] - pow(z[35],2)*z[247];
  z[249] = -z[17]*z[29] - z[18]*z[30];
  z[250] = -z[29]*z[24] - z[30]*z[33];
  z[251] = par->FootMass*(z[34]*z[47]+z[35]*z[51]+z[35]*z[250]+z[249]*z[52]);
  z[252] = par->FootMass*z[35]*(z[34]+z[249]);
  z[253] = -z[19]*z[29] - z[20]*z[30];
  z[254] = par->FootMass*(z[34]*z[37]+z[35]*z[36]+z[35]*z[253]+z[37]*z[249]);
  z[255] = z[22]*z[30] - z[29]*z[31];
  z[256] = par->FootMass*(z[34]*z[40]+z[35]*z[43]+z[35]*z[255]+z[44]*z[249]);
  z[257] = par->FootMass*(par->FootCMx*z[249]-par->FootCMy*z[35]);
  z[258] = par->FootMass*(z[35]*z[42]+z[45]*z[249]-par->ShankLen*z[29]*z[35]-
  par->ShankLen*z[30]*z[34]);
  z[259] = par->ContactHeelX*z[37] + par->ContactY*z[253];
  z[260] = z[37]*(z[249]*q1p+z[255]*q3p+z[255]*q4p-par->ShankLen*z[29]*q5p) + 
  z[36]*(z[35]*q1p+z[40]*q3p+z[40]*q4p+2*z[37]*q2p-par->ShankLen*z[30]*q5p) + 
  z[253]*(par->ContactHeelX*q6p+z[35]*q1p+z[107]*q3p+z[107]*q4p+z[108]*q5p+2*
  z[37]*q2p) - z[37]*(par->ContactY*q6p-z[34]*q1p-z[105]*q5p-z[106]*q3p-
  z[106]*q4p);
  z[261] = par->ContactDamp*(yRHeel-par->ContactStiff*pow(dRHeel,3))*z[260] - 
  z[259]*(1+1.5*par->ContactStiff*pow(dRHeel,2)*(1-yRHeel/z[164]))*(1-par->ContactDamp*
  ydotRHeel);
  z[262] = par->ContactToeX*z[37] + par->ContactY*z[253];
  z[263] = z[37]*(z[249]*q1p+z[255]*q3p+z[255]*q4p-par->ShankLen*z[29]*q5p) + 
  z[36]*(z[35]*q1p+z[40]*q3p+z[40]*q4p+2*z[37]*q2p-par->ShankLen*z[30]*q5p) + 
  z[253]*(par->ContactToeX*q6p+z[35]*q1p+z[109]*q3p+z[109]*q4p+z[110]*q5p+2*
  z[37]*q2p) - z[37]*(par->ContactY*q6p-z[34]*q1p-z[105]*q5p-z[106]*q3p-
  z[106]*q4p);
  z[264] = par->ContactDamp*(yRToe-par->ContactStiff*pow(dRToe,3))*z[263] - 
  z[262]*(1+1.5*par->ContactStiff*pow(dRToe,2)*(1-yRToe/z[166]))*(1-par->ContactDamp*
  ydotRToe);
  z[265] = z[35]*(z[253]*q2p+z[255]*q3p+z[255]*q4p-par->ShankLen*z[29]*q5p) + 
  z[34]*(z[37]*q2p+z[40]*q3p+z[40]*q4p+2*z[35]*q1p-par->ShankLen*z[30]*q5p) + 
  z[249]*(par->ContactHeelX*q6p+z[37]*q2p+z[107]*q3p+z[107]*q4p+z[108]*q5p+2*
  z[35]*q1p) - z[35]*(par->ContactY*q6p-z[36]*q2p-z[105]*q5p-z[106]*q3p-
  z[106]*q4p);
  z[266] = par->ContactFric*(z[261]*(-1+2/(1+z[172]))+2*FyRHeel*z[172]*z[265]/(
  par->ContactV0*pow((1+z[172]),2)));
  z[267] = z[35]*(z[253]*q2p+z[255]*q3p+z[255]*q4p-par->ShankLen*z[29]*q5p) + 
  z[34]*(z[37]*q2p+z[40]*q3p+z[40]*q4p+2*z[35]*q1p-par->ShankLen*z[30]*q5p) + 
  z[249]*(par->ContactToeX*q6p+z[37]*q2p+z[109]*q3p+z[109]*q4p+z[110]*q5p+2*
  z[35]*q1p) - z[35]*(par->ContactY*q6p-z[36]*q2p-z[105]*q5p-z[106]*q3p-
  z[106]*q4p);
  z[268] = par->ContactFric*(z[264]*(-1+2/(1+z[173]))+2*FyRToe*z[173]*z[267]/(
  par->ContactV0*pow((1+z[173]),2)));
  z[269] = z[34]*z[36]*z[261] + z[34]*z[36]*z[264] + z[34]*z[37]*FyRHeel + 
  z[34]*z[37]*FyRToe + z[35]*z[36]*FyRHeel + z[35]*z[36]*FyRToe + z[35]*z[37]*
  z[261] + z[35]*z[37]*z[264] + z[35]*z[253]*FyRHeel + z[35]*z[253]*FyRToe + 
  z[37]*z[249]*FyRHeel + z[37]*z[249]*FyRToe + 2*z[34]*z[35]*FxRHeel + 2*
  z[34]*z[35]*FxRToe + 2*z[35]*z[249]*FxRHeel + 2*z[35]*z[249]*FxRToe - 
  z[101]*(z[34]*z[37]+z[35]*z[36]+z[35]*z[253]+z[37]*z[249]) - pow(z[34],2)*
  z[266] - pow(z[34],2)*z[268] - pow(z[35],2)*z[266] - pow(z[35],2)*z[268];
  z[270] = par->FootMass*(z[185]*z[99]+z[186]*z[100]) + par->ShankMass*(
  z[183]*z[72]+z[184]*z[76]) - par->ThighMass*z[182]*z[60];
  z[271] = 2*par->ThighMass*z[56]*(z[55]+z[182]) + 2*par->FootMass*(z[82]*
  z[185]+z[83]*z[186]) + 2*par->ShankMass*(z[65]*z[183]+z[66]*z[184]);
  z[272] = par->ThighMass*z[55]*(z[55]+z[182]) + par->ThighMass*z[56]*(z[56]+
  z[57]) + par->FootMass*(pow(z[82],2)+pow(z[83],2)+z[84]*z[185]+z[85]*z[186]) + 
  par->ShankMass*(pow(z[65],2)+pow(z[66],2)+z[67]*z[183]+z[68]*z[184]);
  z[273] = z[82]*z[84]*z[209] + z[82]*z[84]*z[212] + pow(z[82],2)*FyLHeel + 
  pow(z[82],2)*FyLToe + z[83]*z[85]*z[209] + z[83]*z[85]*z[212] + pow(z[83],2)*
  FyLHeel + pow(z[83],2)*FyLToe + z[84]*z[185]*FyLHeel + z[84]*z[185]*FyLToe + 
  z[85]*z[186]*FyLHeel + z[85]*z[186]*FyLToe + 2*z[82]*z[185]*FxLHeel + 2*
  z[82]*z[185]*FxLToe + 2*z[83]*z[186]*FxLHeel + 2*z[83]*z[186]*FxLToe - 
  z[55]*z[103]*(z[55]+z[182]) - z[56]*z[103]*(z[56]+z[57]) - z[101]*(pow(
  z[82],2)+pow(z[83],2)+z[84]*z[185]+z[85]*z[186]) - z[102]*(pow(z[65],2)+
  pow(z[66],2)+z[67]*z[183]+z[68]*z[184]) - pow(z[82],2)*z[214] - pow(z[82],2)*
  z[216] - pow(z[83],2)*z[214] - pow(z[83],2)*z[216];
  z[274] = -z[55]*z[61] - z[56]*z[62];
  z[275] = z[66]*z[77] + z[78]*z[274];
  z[276] = (z[61]*z[77]-z[62]*z[78])*z[64];
  z[277] = z[77]*z[274] - z[66]*z[78];
  z[278] = (z[61]*z[78]+z[62]*z[77])*z[64];
  z[279] = par->ShankMass*(z[66]*z[72]+z[274]*z[76]+z[61]*z[65]*z[64]-z[62]*
  z[66]*z[64]) - par->FootMass*(z[83]*z[278]-z[82]*z[276]-z[275]*z[99]-z[277]*
  z[100]);
  z[280] = par->FootMass*(par->FootCMx*z[277]-par->FootCMy*z[275]);
  z[281] = 2*par->ShankMass*z[66]*(z[65]+z[274]) + 2*par->FootMass*(z[82]*
  z[275]+z[83]*z[277]);
  z[282] = -z[55]*z[62] - z[57]*z[61];
  z[283] = z[68]*z[77] + z[78]*z[282];
  z[284] = z[77]*z[282] - z[68]*z[78];
  z[285] = par->FootMass*(z[82]*z[283]+z[83]*z[284]+z[84]*z[275]+z[85]*z[277]) + 
  par->ShankMass*(z[65]*z[68]+z[66]*z[67]+z[66]*z[282]+z[68]*z[274]);
  z[286] = par->ThighLen*(z[61]*z[78]+z[62]*z[77]);
  z[287] = par->ThighLen*(z[61]*z[77]-z[62]*z[78]);
  z[288] = par->ShankMass*(z[66]*z[71]-z[70]*z[274]-par->ThighLen*z[61]*z[66]-
  par->ThighLen*z[62]*z[65]) - par->FootMass*(z[82]*z[286]+z[83]*z[287]-z[91]*
  z[275]-z[92]*z[277]);
  z[289] = par->FootMass*(z[90]*z[275]+z[93]*z[277]) - par->ShankCMy*par->ShankMass*
  z[66];
  z[290] = par->ContactHeelX*z[283] + par->ContactY*z[284] - par->ShankLen*
  z[282];
  z[291] = z[284]*(par->ContactHeelX*q9p+z[83]*q1p+z[113]*q3p+z[113]*q7p+
  z[114]*q8p) + z[84]*(z[275]*q1p+2*z[283]*q2p-z[286]*q3p-z[286]*q7p) + z[85]*(
  z[277]*q1p+2*z[284]*q2p-z[287]*q3p-z[287]*q7p) - z[283]*(par->ContactY*q9p-
  z[82]*q1p-z[111]*q8p-z[112]*q3p-z[112]*q7p);
  z[292] = par->ContactDamp*(yLHeel-par->ContactStiff*pow(dLHeel,3))*z[291] - 
  z[290]*(1+1.5*par->ContactStiff*pow(dLHeel,2)*(1-yLHeel/z[168]))*(1-par->ContactDamp*
  ydotLHeel);
  z[293] = par->ContactToeX*z[283] + par->ContactY*z[284] - par->ShankLen*
  z[282];
  z[294] = z[284]*(par->ContactToeX*q9p+z[83]*q1p+z[115]*q3p+z[115]*q7p+
  z[116]*q8p) + z[84]*(z[275]*q1p+2*z[283]*q2p-z[286]*q3p-z[286]*q7p) + z[85]*(
  z[277]*q1p+2*z[284]*q2p-z[287]*q3p-z[287]*q7p) - z[283]*(par->ContactY*q9p-
  z[82]*q1p-z[111]*q8p-z[112]*q3p-z[112]*q7p);
  z[295] = par->ContactDamp*(yLToe-par->ContactStiff*pow(dLToe,3))*z[294] - 
  z[293]*(1+1.5*par->ContactStiff*pow(dLToe,2)*(1-yLToe/z[170]))*(1-par->ContactDamp*
  ydotLToe);
  z[296] = z[277]*(par->ContactHeelX*q9p+z[85]*q2p+z[113]*q3p+z[113]*q7p+
  z[114]*q8p) + z[82]*(z[283]*q2p+2*z[275]*q1p-z[286]*q3p-z[286]*q7p) + z[83]*(
  z[284]*q2p+2*z[277]*q1p-z[287]*q3p-z[287]*q7p) - z[275]*(par->ContactY*q9p-
  z[84]*q2p-z[111]*q8p-z[112]*q3p-z[112]*q7p);
  z[297] = par->ContactFric*(z[292]*(-1+2/(1+z[174]))+2*FyLHeel*z[174]*z[296]/(
  par->ContactV0*pow((1+z[174]),2)));
  z[298] = z[277]*(par->ContactToeX*q9p+z[85]*q2p+z[115]*q3p+z[115]*q7p+
  z[116]*q8p) + z[82]*(z[283]*q2p+2*z[275]*q1p-z[286]*q3p-z[286]*q7p) + z[83]*(
  z[284]*q2p+2*z[277]*q1p-z[287]*q3p-z[287]*q7p) - z[275]*(par->ContactY*q9p-
  z[84]*q2p-z[111]*q8p-z[112]*q3p-z[112]*q7p);
  z[299] = par->ContactFric*(z[295]*(-1+2/(1+z[175]))+2*FyLToe*z[175]*z[298]/(
  par->ContactV0*pow((1+z[175]),2)));
  z[300] = z[82]*z[84]*z[292] + z[82]*z[84]*z[295] + z[82]*z[283]*FyLHeel + 
  z[82]*z[283]*FyLToe + z[83]*z[85]*z[292] + z[83]*z[85]*z[295] + z[83]*
  z[284]*FyLHeel + z[83]*z[284]*FyLToe + z[84]*z[275]*FyLHeel + z[84]*z[275]*
  FyLToe + z[85]*z[277]*FyLHeel + z[85]*z[277]*FyLToe + 2*z[82]*z[275]*FxLHeel + 
  2*z[82]*z[275]*FxLToe + 2*z[83]*z[277]*FxLHeel + 2*z[83]*z[277]*FxLToe - 
  z[101]*(z[82]*z[283]+z[83]*z[284]+z[84]*z[275]+z[85]*z[277]) - z[102]*(
  z[65]*z[68]+z[66]*z[67]+z[66]*z[282]+z[68]*z[274]) - pow(z[82],2)*z[297] - 
  pow(z[82],2)*z[299] - pow(z[83],2)*z[297] - pow(z[83],2)*z[299];
  z[301] = -z[65]*z[77] - z[66]*z[78];
  z[302] = -z[77]*z[72] - z[78]*z[81];
  z[303] = par->FootMass*(z[82]*z[95]+z[83]*z[99]+z[83]*z[302]+z[301]*z[100]);
  z[304] = par->FootMass*(par->FootCMx*z[301]-par->FootCMy*z[83]);
  z[305] = par->FootMass*z[83]*(z[82]+z[301]);
  z[306] = -z[67]*z[77] - z[68]*z[78];
  z[307] = par->FootMass*(z[82]*z[85]+z[83]*z[84]+z[83]*z[306]+z[85]*z[301]);
  z[308] = z[70]*z[78] - z[77]*z[79];
  z[309] = par->FootMass*(z[82]*z[88]+z[83]*z[91]+z[83]*z[308]+z[92]*z[301]);
  z[310] = par->FootMass*(z[83]*z[90]+z[93]*z[301]-par->ShankLen*z[77]*z[83]-
  par->ShankLen*z[78]*z[82]);
  z[311] = par->ContactHeelX*z[85] + par->ContactY*z[306];
  z[312] = z[85]*(z[301]*q1p+z[308]*q3p+z[308]*q7p-par->ShankLen*z[77]*q8p) + 
  z[84]*(z[83]*q1p+z[88]*q3p+z[88]*q7p+2*z[85]*q2p-par->ShankLen*z[78]*q8p) + 
  z[306]*(par->ContactHeelX*q9p+z[83]*q1p+z[113]*q3p+z[113]*q7p+z[114]*q8p+2*
  z[85]*q2p) - z[85]*(par->ContactY*q9p-z[82]*q1p-z[111]*q8p-z[112]*q3p-
  z[112]*q7p);
  z[313] = par->ContactDamp*(yLHeel-par->ContactStiff*pow(dLHeel,3))*z[312] - 
  z[311]*(1+1.5*par->ContactStiff*pow(dLHeel,2)*(1-yLHeel/z[168]))*(1-par->ContactDamp*
  ydotLHeel);
  z[314] = par->ContactToeX*z[85] + par->ContactY*z[306];
  z[315] = z[85]*(z[301]*q1p+z[308]*q3p+z[308]*q7p-par->ShankLen*z[77]*q8p) + 
  z[84]*(z[83]*q1p+z[88]*q3p+z[88]*q7p+2*z[85]*q2p-par->ShankLen*z[78]*q8p) + 
  z[306]*(par->ContactToeX*q9p+z[83]*q1p+z[115]*q3p+z[115]*q7p+z[116]*q8p+2*
  z[85]*q2p) - z[85]*(par->ContactY*q9p-z[82]*q1p-z[111]*q8p-z[112]*q3p-
  z[112]*q7p);
  z[316] = par->ContactDamp*(yLToe-par->ContactStiff*pow(dLToe,3))*z[315] - 
  z[314]*(1+1.5*par->ContactStiff*pow(dLToe,2)*(1-yLToe/z[170]))*(1-par->ContactDamp*
  ydotLToe);
  z[317] = z[83]*(z[306]*q2p+z[308]*q3p+z[308]*q7p-par->ShankLen*z[77]*q8p) + 
  z[82]*(z[85]*q2p+z[88]*q3p+z[88]*q7p+2*z[83]*q1p-par->ShankLen*z[78]*q8p) + 
  z[301]*(par->ContactHeelX*q9p+z[85]*q2p+z[113]*q3p+z[113]*q7p+z[114]*q8p+2*
  z[83]*q1p) - z[83]*(par->ContactY*q9p-z[84]*q2p-z[111]*q8p-z[112]*q3p-
  z[112]*q7p);
  z[318] = par->ContactFric*(z[313]*(-1+2/(1+z[174]))+2*FyLHeel*z[174]*z[317]/(
  par->ContactV0*pow((1+z[174]),2)));
  z[319] = z[83]*(z[306]*q2p+z[308]*q3p+z[308]*q7p-par->ShankLen*z[77]*q8p) + 
  z[82]*(z[85]*q2p+z[88]*q3p+z[88]*q7p+2*z[83]*q1p-par->ShankLen*z[78]*q8p) + 
  z[301]*(par->ContactToeX*q9p+z[85]*q2p+z[115]*q3p+z[115]*q7p+z[116]*q8p+2*
  z[83]*q1p) - z[83]*(par->ContactY*q9p-z[84]*q2p-z[111]*q8p-z[112]*q3p-
  z[112]*q7p);
  z[320] = par->ContactFric*(z[316]*(-1+2/(1+z[175]))+2*FyLToe*z[175]*z[319]/(
  par->ContactV0*pow((1+z[175]),2)));
  z[321] = z[82]*z[84]*z[313] + z[82]*z[84]*z[316] + z[82]*z[85]*FyLHeel + 
  z[82]*z[85]*FyLToe + z[83]*z[84]*FyLHeel + z[83]*z[84]*FyLToe + z[83]*z[85]*
  z[313] + z[83]*z[85]*z[316] + z[83]*z[306]*FyLHeel + z[83]*z[306]*FyLToe + 
  z[85]*z[301]*FyLHeel + z[85]*z[301]*FyLToe + 2*z[82]*z[83]*FxLHeel + 2*
  z[82]*z[83]*FxLToe + 2*z[83]*z[301]*FxLHeel + 2*z[83]*z[301]*FxLToe - 
  z[101]*(z[82]*z[85]+z[83]*z[84]+z[83]*z[306]+z[85]*z[301]) - pow(z[82],2)*
  z[318] - pow(z[82],2)*z[320] - pow(z[83],2)*z[318] - pow(z[83],2)*z[320];
  z[322] = par->ContactFric*z[34]*z[36]*z[165]*(-1+2/(1+z[172])) + par->ContactFric*
  z[34]*z[36]*z[167]*(-1+2/(1+z[173])) + par->ContactFric*z[35]*z[37]*z[165]*(
  -1+2/(1+z[172])) + par->ContactFric*z[35]*z[37]*z[167]*(-1+2/(1+z[173])) + 
  par->ContactFric*z[82]*z[84]*z[169]*(-1+2/(1+z[174])) + par->ContactFric*
  z[82]*z[84]*z[171]*(-1+2/(1+z[175])) + par->ContactFric*z[83]*z[85]*z[169]*(
  -1+2/(1+z[174])) + par->ContactFric*z[83]*z[85]*z[171]*(-1+2/(1+z[175])) - 
  pow(z[36],2)*z[165] - pow(z[36],2)*z[167] - pow(z[37],2)*z[165] - pow(z[37],
  2)*z[167] - pow(z[84],2)*z[169] - pow(z[84],2)*z[171] - pow(z[85],2)*z[169] - 
  pow(z[85],2)*z[171];
  z[323] = 2*par->ThighMass*z[7]*(z[8]+z[9]) + 2*par->ThighMass*z[55]*(z[56]+
  z[57]) + 2*par->FootMass*(z[34]*z[36]+z[35]*z[37]) + 2*par->FootMass*(z[82]*
  z[84]+z[83]*z[85]) + 2*par->ShankMass*(z[17]*z[19]+z[18]*z[20]) + 2*par->ShankMass*(
  z[65]*z[67]+z[66]*z[68]);
  z[324] = pow(z[34],2)*FxRHeel + pow(z[34],2)*FxRToe + pow(z[35],2)*FxRHeel + 
  pow(z[35],2)*FxRToe + z[36]*z[180]*FxRHeel + z[36]*z[180]*FxRToe + pow(
  z[36],2)*z[199] + pow(z[36],2)*z[202] + z[37]*z[181]*FxRHeel + z[37]*z[181]*
  FxRToe + pow(z[37],2)*z[199] + pow(z[37],2)*z[202] + pow(z[82],2)*FxLHeel + 
  pow(z[82],2)*FxLToe + pow(z[83],2)*FxLHeel + pow(z[83],2)*FxLToe + z[84]*
  z[185]*FxLHeel + z[84]*z[185]*FxLToe + pow(z[84],2)*z[209] + pow(z[84],2)*
  z[212] + z[85]*z[186]*FxLHeel + z[85]*z[186]*FxLToe + pow(z[85],2)*z[209] + 
  pow(z[85],2)*z[212] + 2*z[34]*z[36]*FyRHeel + 2*z[34]*z[36]*FyRToe + 2*
  z[35]*z[37]*FyRHeel + 2*z[35]*z[37]*FyRToe + 2*z[82]*z[84]*FyLHeel + 2*
  z[82]*z[84]*FyLToe + 2*z[83]*z[85]*FyLHeel + 2*z[83]*z[85]*FyLToe - 2*z[7]*
  z[103]*(z[8]+z[9]) - 2*z[55]*z[103]*(z[56]+z[57]) - 2*z[101]*(z[34]*z[36]+
  z[35]*z[37]) - 2*z[101]*(z[82]*z[84]+z[83]*z[85]) - 2*z[102]*(z[17]*z[19]+
  z[18]*z[20]) - 2*z[102]*(z[65]*z[67]+z[66]*z[68]) - z[34]*z[36]*z[204] - 
  z[34]*z[36]*z[206] - z[35]*z[37]*z[204] - z[35]*z[37]*z[206] - z[82]*z[84]*
  z[214] - z[82]*z[84]*z[216] - z[83]*z[85]*z[214] - z[83]*z[85]*z[216];
  z[325] = par->FootMass*(z[34]*z[51]+z[35]*z[52]) + par->ShankMass*(z[17]*
  z[24]+z[18]*z[28]) - par->ThighMass*z[8]*z[12];
  z[326] = 2*par->ThighMass*z[7]*(z[8]+z[9]) + 2*par->FootMass*(z[34]*z[36]+
  z[35]*z[37]) + 2*par->ShankMass*(z[17]*z[19]+z[18]*z[20]);
  z[327] = pow(z[34],2)*FxRHeel + pow(z[34],2)*FxRToe + pow(z[35],2)*FxRHeel + 
  pow(z[35],2)*FxRToe + z[36]*z[180]*FxRHeel + z[36]*z[180]*FxRToe + pow(
  z[36],2)*z[199] + pow(z[36],2)*z[202] + z[37]*z[181]*FxRHeel + z[37]*z[181]*
  FxRToe + pow(z[37],2)*z[199] + pow(z[37],2)*z[202] + 2*z[34]*z[36]*FyRHeel + 
  2*z[34]*z[36]*FyRToe + 2*z[35]*z[37]*FyRHeel + 2*z[35]*z[37]*FyRToe - 2*
  z[7]*z[103]*(z[8]+z[9]) - 2*z[101]*(z[34]*z[36]+z[35]*z[37]) - 2*z[102]*(
  z[17]*z[19]+z[18]*z[20]) - z[34]*z[36]*z[204] - z[34]*z[36]*z[206] - z[35]*
  z[37]*z[204] - z[35]*z[37]*z[206];
  z[328] = par->ShankMass*(z[20]*z[24]+z[229]*z[28]+z[13]*z[19]*z[16]-z[14]*
  z[20]*z[16]) - par->FootMass*(z[37]*z[226]-z[36]*z[224]-z[230]*z[51]-z[231]*
  z[52]);
  z[329] = 2*par->ShankMass*z[20]*(z[19]+z[229]) + 2*par->FootMass*(z[36]*
  z[230]+z[37]*z[231]);
  z[330] = par->ShankMass*(z[20]*z[23]-z[22]*z[229]-par->ThighLen*z[13]*z[20]-
  par->ThighLen*z[14]*z[19]) - par->FootMass*(z[36]*z[233]+z[37]*z[234]-z[43]*
  z[230]-z[44]*z[231]);
  z[331] = par->FootMass*(par->FootCMx*z[231]-par->FootCMy*z[230]);
  z[332] = par->FootMass*(z[42]*z[230]+z[45]*z[231]) - par->ShankCMy*par->ShankMass*
  z[20];
  z[333] = z[34]*z[230]*FxRHeel + z[34]*z[230]*FxRToe + z[35]*z[231]*FxRHeel + 
  z[35]*z[231]*FxRToe + z[36]*z[223]*FxRHeel + z[36]*z[223]*FxRToe + pow(
  z[36],2)*z[240] + pow(z[36],2)*z[243] + z[37]*z[225]*FxRHeel + z[37]*z[225]*
  FxRToe + pow(z[37],2)*z[240] + pow(z[37],2)*z[243] + 2*z[36]*z[230]*FyRHeel + 
  2*z[36]*z[230]*FyRToe + 2*z[37]*z[231]*FyRHeel + 2*z[37]*z[231]*FyRToe - 2*
  z[20]*z[102]*(z[19]+z[229]) - 2*z[101]*(z[36]*z[230]+z[37]*z[231]) - z[34]*
  z[36]*z[245] - z[34]*z[36]*z[247] - z[35]*z[37]*z[245] - z[35]*z[37]*z[247];
  z[334] = par->FootMass*(z[36]*z[47]+z[37]*z[51]+z[37]*z[250]+z[253]*z[52]);
  z[335] = par->FootMass*z[37]*(z[36]+z[253]);
  z[336] = par->FootMass*(z[36]*z[40]+z[37]*z[43]+z[37]*z[255]+z[44]*z[253]);
  z[337] = par->FootMass*(par->FootCMx*z[253]-par->FootCMy*z[37]);
  z[338] = par->FootMass*(z[37]*z[42]+z[45]*z[253]-par->ShankLen*z[29]*z[37]-
  par->ShankLen*z[30]*z[36]);
  z[339] = z[34]*z[37]*FxRHeel + z[34]*z[37]*FxRToe + z[35]*z[36]*FxRHeel + 
  z[35]*z[36]*FxRToe + z[35]*z[253]*FxRHeel + z[35]*z[253]*FxRToe + pow(z[36],
  2)*z[261] + pow(z[36],2)*z[264] + z[37]*z[249]*FxRHeel + z[37]*z[249]*
  FxRToe + pow(z[37],2)*z[261] + pow(z[37],2)*z[264] + 2*z[36]*z[37]*FyRHeel + 
  2*z[36]*z[37]*FyRToe + 2*z[37]*z[253]*FyRHeel + 2*z[37]*z[253]*FyRToe - 2*
  z[37]*z[101]*(z[36]+z[253]) - z[34]*z[36]*z[266] - z[34]*z[36]*z[268] - 
  z[35]*z[37]*z[266] - z[35]*z[37]*z[268];
  z[340] = par->FootMass*(z[82]*z[99]+z[83]*z[100]) + par->ShankMass*(z[65]*
  z[72]+z[66]*z[76]) - par->ThighMass*z[56]*z[60];
  z[341] = 2*par->ThighMass*z[55]*(z[56]+z[57]) + 2*par->FootMass*(z[82]*
  z[84]+z[83]*z[85]) + 2*par->ShankMass*(z[65]*z[67]+z[66]*z[68]);
  z[342] = pow(z[82],2)*FxLHeel + pow(z[82],2)*FxLToe + pow(z[83],2)*FxLHeel + 
  pow(z[83],2)*FxLToe + z[84]*z[185]*FxLHeel + z[84]*z[185]*FxLToe + pow(
  z[84],2)*z[209] + pow(z[84],2)*z[212] + z[85]*z[186]*FxLHeel + z[85]*z[186]*
  FxLToe + pow(z[85],2)*z[209] + pow(z[85],2)*z[212] + 2*z[82]*z[84]*FyLHeel + 
  2*z[82]*z[84]*FyLToe + 2*z[83]*z[85]*FyLHeel + 2*z[83]*z[85]*FyLToe - 2*
  z[55]*z[103]*(z[56]+z[57]) - 2*z[101]*(z[82]*z[84]+z[83]*z[85]) - 2*z[102]*(
  z[65]*z[67]+z[66]*z[68]) - z[82]*z[84]*z[214] - z[82]*z[84]*z[216] - z[83]*
  z[85]*z[214] - z[83]*z[85]*z[216];
  z[343] = par->ShankMass*(z[68]*z[72]+z[282]*z[76]+z[61]*z[67]*z[64]-z[62]*
  z[68]*z[64]) - par->FootMass*(z[85]*z[278]-z[84]*z[276]-z[283]*z[99]-z[284]*
  z[100]);
  z[344] = par->FootMass*(par->FootCMx*z[284]-par->FootCMy*z[283]);
  z[345] = 2*par->ShankMass*z[68]*(z[67]+z[282]) + 2*par->FootMass*(z[84]*
  z[283]+z[85]*z[284]);
  z[346] = par->ShankMass*(z[68]*z[71]-z[70]*z[282]-par->ThighLen*z[61]*z[68]-
  par->ThighLen*z[62]*z[67]) - par->FootMass*(z[84]*z[286]+z[85]*z[287]-z[91]*
  z[283]-z[92]*z[284]);
  z[347] = par->FootMass*(z[90]*z[283]+z[93]*z[284]) - par->ShankCMy*par->ShankMass*
  z[68];
  z[348] = z[82]*z[283]*FxLHeel + z[82]*z[283]*FxLToe + z[83]*z[284]*FxLHeel + 
  z[83]*z[284]*FxLToe + z[84]*z[275]*FxLHeel + z[84]*z[275]*FxLToe + pow(
  z[84],2)*z[292] + pow(z[84],2)*z[295] + z[85]*z[277]*FxLHeel + z[85]*z[277]*
  FxLToe + pow(z[85],2)*z[292] + pow(z[85],2)*z[295] + 2*z[84]*z[283]*FyLHeel + 
  2*z[84]*z[283]*FyLToe + 2*z[85]*z[284]*FyLHeel + 2*z[85]*z[284]*FyLToe - 2*
  z[68]*z[102]*(z[67]+z[282]) - 2*z[101]*(z[84]*z[283]+z[85]*z[284]) - z[82]*
  z[84]*z[297] - z[82]*z[84]*z[299] - z[83]*z[85]*z[297] - z[83]*z[85]*z[299];
  z[349] = par->FootMass*(z[84]*z[95]+z[85]*z[99]+z[85]*z[302]+z[306]*z[100]);
  z[350] = par->FootMass*(par->FootCMx*z[306]-par->FootCMy*z[85]);
  z[351] = par->FootMass*z[85]*(z[84]+z[306]);
  z[352] = par->FootMass*(z[84]*z[88]+z[85]*z[91]+z[85]*z[308]+z[92]*z[306]);
  z[353] = par->FootMass*(z[85]*z[90]+z[93]*z[306]-par->ShankLen*z[77]*z[85]-
  par->ShankLen*z[78]*z[84]);
  z[354] = z[82]*z[85]*FxLHeel + z[82]*z[85]*FxLToe + z[83]*z[84]*FxLHeel + 
  z[83]*z[84]*FxLToe + z[83]*z[306]*FxLHeel + z[83]*z[306]*FxLToe + pow(z[84],
  2)*z[313] + pow(z[84],2)*z[316] + z[85]*z[301]*FxLHeel + z[85]*z[301]*
  FxLToe + pow(z[85],2)*z[313] + pow(z[85],2)*z[316] + 2*z[84]*z[85]*FyLHeel + 
  2*z[84]*z[85]*FyLToe + 2*z[85]*z[306]*FyLHeel + 2*z[85]*z[306]*FyLToe - 2*
  z[85]*z[101]*(z[84]+z[306]) - z[82]*z[84]*z[318] - z[82]*z[84]*z[320] - 
  z[83]*z[85]*z[318] - z[83]*z[85]*z[320];
  z[355] = par->ContactFric*z[34]*z[106]*z[165]*(-1+2/(1+z[172])) + par->ContactFric*
  z[34]*z[106]*z[167]*(-1+2/(1+z[173])) + par->ContactFric*z[35]*z[107]*
  z[165]*(-1+2/(1+z[172])) + par->ContactFric*z[35]*z[109]*z[167]*(-1+2/(1+
  z[173])) + par->ContactFric*z[82]*z[112]*z[169]*(-1+2/(1+z[174])) + par->ContactFric*
  z[82]*z[112]*z[171]*(-1+2/(1+z[175])) + par->ContactFric*z[83]*z[113]*
  z[169]*(-1+2/(1+z[174])) + par->ContactFric*z[83]*z[115]*z[171]*(-1+2/(1+
  z[175])) - z[36]*z[106]*z[165] - z[36]*z[106]*z[167] - z[37]*z[107]*z[165] - 
  z[37]*z[109]*z[167] - z[84]*z[112]*z[169] - z[84]*z[112]*z[171] - z[85]*
  z[113]*z[169] - z[85]*z[115]*z[171];
  z[356] = par->ThighCMy*z[7]*z[103] + par->ThighCMy*z[55]*z[103] + par->TrunkCMy*
  z[1]*z[104] + z[34]*z[106]*FyRHeel + z[34]*z[106]*FyRToe + z[35]*z[107]*
  FyRHeel + z[35]*z[109]*FyRToe + z[36]*z[106]*z[199] + z[36]*z[106]*z[202] + 
  z[37]*z[107]*z[199] + z[37]*z[109]*z[202] + z[82]*z[112]*FyLHeel + z[82]*
  z[112]*FyLToe + z[83]*z[113]*FyLHeel + z[83]*z[115]*FyLToe + z[84]*z[112]*
  z[209] + z[84]*z[112]*z[212] + z[85]*z[113]*z[209] + z[85]*z[115]*z[212] + 
  z[106]*z[180]*FxRHeel + z[106]*z[180]*FxRToe + z[107]*z[181]*FxRHeel + 
  z[109]*z[181]*FxRToe + z[112]*z[185]*FxLHeel + z[112]*z[185]*FxLToe + 
  z[113]*z[186]*FxLHeel + z[115]*z[186]*FxLToe - z[101]*(z[34]*z[43]+z[35]*
  z[44]) - z[101]*(z[82]*z[91]+z[83]*z[92]) - z[102]*(z[17]*z[23]-z[18]*z[22]) - 
  z[102]*(z[65]*z[71]-z[66]*z[70]) - z[34]*z[106]*z[204] - z[34]*z[106]*
  z[206] - z[35]*z[107]*z[204] - z[35]*z[109]*z[206] - z[82]*z[112]*z[214] - 
  z[82]*z[112]*z[216] - z[83]*z[113]*z[214] - z[83]*z[115]*z[216];
  z[357] = par->ThighCMy*z[7]*z[103] + z[34]*z[106]*FyRHeel + z[34]*z[106]*
  FyRToe + z[35]*z[107]*FyRHeel + z[35]*z[109]*FyRToe + z[36]*z[106]*z[199] + 
  z[36]*z[106]*z[202] + z[37]*z[107]*z[199] + z[37]*z[109]*z[202] + z[106]*
  z[180]*FxRHeel + z[106]*z[180]*FxRToe + z[107]*z[181]*FxRHeel + z[109]*
  z[181]*FxRToe - z[101]*(z[34]*z[43]+z[35]*z[44]) - z[102]*(z[17]*z[23]-
  z[18]*z[22]) - z[34]*z[106]*z[204] - z[34]*z[106]*z[206] - z[35]*z[107]*
  z[204] - z[35]*z[109]*z[206];
  z[358] = par->FootMass*(z[43]*z[224]-z[44]*z[226]-z[233]*z[51]-z[234]*z[52]) - 
  par->ShankMass*(par->ThighLen*z[13]*z[28]+par->ThighLen*z[14]*z[24]-z[13]*
  z[23]*z[16]-z[14]*z[22]*z[16]);
  z[359] = 2*par->ShankMass*par->ThighLen*(z[13]*z[22]-z[14]*z[23]) - 2*
  par->FootMass*(z[43]*z[233]+z[44]*z[234]);
  z[360] = par->ShankCMy*par->ShankMass*par->ThighLen*z[14] - par->FootMass*(
  z[42]*z[233]+z[45]*z[234]);
  z[361] = par->FootMass*(par->FootCMx*z[234]-par->FootCMy*z[233]);
  z[362] = z[101]*(z[36]*z[233]+z[37]*z[234]-z[43]*z[230]-z[44]*z[231]) + 
  z[36]*z[106]*z[240] + z[36]*z[106]*z[243] + z[37]*z[107]*z[240] + z[37]*
  z[109]*z[243] + z[106]*z[223]*FxRHeel + z[106]*z[223]*FxRToe + z[106]*
  z[230]*FyRHeel + z[106]*z[230]*FyRToe + z[107]*z[225]*FxRHeel + z[107]*
  z[231]*FyRHeel + z[109]*z[225]*FxRToe + z[109]*z[231]*FyRToe - z[102]*(
  z[20]*z[23]-z[22]*z[229]-par->ThighLen*z[13]*z[20]-par->ThighLen*z[14]*
  z[19]) - z[34]*z[106]*z[245] - z[34]*z[106]*z[247] - z[34]*z[233]*FxRHeel - 
  z[34]*z[233]*FxRToe - z[35]*z[107]*z[245] - z[35]*z[109]*z[247] - z[35]*
  z[234]*FxRHeel - z[35]*z[234]*FxRToe - z[36]*z[233]*FyRHeel - z[36]*z[233]*
  FyRToe - z[37]*z[234]*FyRHeel - z[37]*z[234]*FyRToe;
  z[363] = par->FootMass*(z[40]*z[51]+z[43]*z[47]+z[44]*z[250]+z[255]*z[52]);
  z[364] = par->FootMass*(z[40]*z[43]+z[44]*z[255]);
  z[365] = par->FootMass*(z[40]*z[42]+z[45]*z[255]-par->ShankLen*z[29]*z[44]-
  par->ShankLen*z[30]*z[43]);
  z[366] = par->FootMass*(par->FootCMx*z[255]-par->FootCMy*z[40]);
  z[367] = z[34]*z[40]*FxRHeel + z[34]*z[40]*FxRToe + z[35]*z[106]*FxRHeel + 
  z[35]*z[106]*FxRToe + z[35]*z[255]*FxRHeel + z[35]*z[255]*FxRToe + z[36]*
  z[40]*FyRHeel + z[36]*z[40]*FyRToe + z[36]*z[106]*z[261] + z[36]*z[106]*
  z[264] + z[37]*z[106]*FyRHeel + z[37]*z[106]*FyRToe + z[37]*z[107]*z[261] + 
  z[37]*z[109]*z[264] + z[37]*z[255]*FyRHeel + z[37]*z[255]*FyRToe + z[107]*
  z[249]*FxRHeel + z[107]*z[253]*FyRHeel + z[109]*z[249]*FxRToe + z[109]*
  z[253]*FyRToe - z[101]*(z[36]*z[40]+z[37]*z[43]+z[37]*z[255]+z[44]*z[253]) - 
  z[34]*z[106]*z[266] - z[34]*z[106]*z[268] - z[35]*z[107]*z[266] - z[35]*
  z[109]*z[268];
  z[368] = par->ThighCMy*z[55]*z[103] + z[82]*z[112]*FyLHeel + z[82]*z[112]*
  FyLToe + z[83]*z[113]*FyLHeel + z[83]*z[115]*FyLToe + z[84]*z[112]*z[209] + 
  z[84]*z[112]*z[212] + z[85]*z[113]*z[209] + z[85]*z[115]*z[212] + z[112]*
  z[185]*FxLHeel + z[112]*z[185]*FxLToe + z[113]*z[186]*FxLHeel + z[115]*
  z[186]*FxLToe - z[101]*(z[82]*z[91]+z[83]*z[92]) - z[102]*(z[65]*z[71]-
  z[66]*z[70]) - z[82]*z[112]*z[214] - z[82]*z[112]*z[216] - z[83]*z[113]*
  z[214] - z[83]*z[115]*z[216];
  z[369] = par->FootMass*(z[91]*z[276]-z[92]*z[278]-z[286]*z[99]-z[287]*
  z[100]) - par->ShankMass*(par->ThighLen*z[61]*z[76]+par->ThighLen*z[62]*
  z[72]-z[61]*z[71]*z[64]-z[62]*z[70]*z[64]);
  z[370] = 2*par->ShankMass*par->ThighLen*(z[61]*z[70]-z[62]*z[71]) - 2*
  par->FootMass*(z[91]*z[286]+z[92]*z[287]);
  z[371] = par->ShankCMy*par->ShankMass*par->ThighLen*z[62] - par->FootMass*(
  z[90]*z[286]+z[93]*z[287]);
  z[372] = par->FootMass*(par->FootCMx*z[287]-par->FootCMy*z[286]);
  z[373] = z[101]*(z[84]*z[286]+z[85]*z[287]-z[91]*z[283]-z[92]*z[284]) + 
  z[84]*z[112]*z[292] + z[84]*z[112]*z[295] + z[85]*z[113]*z[292] + z[85]*
  z[115]*z[295] + z[112]*z[275]*FxLHeel + z[112]*z[275]*FxLToe + z[112]*
  z[283]*FyLHeel + z[112]*z[283]*FyLToe + z[113]*z[277]*FxLHeel + z[113]*
  z[284]*FyLHeel + z[115]*z[277]*FxLToe + z[115]*z[284]*FyLToe - z[102]*(
  z[68]*z[71]-z[70]*z[282]-par->ThighLen*z[61]*z[68]-par->ThighLen*z[62]*
  z[67]) - z[82]*z[112]*z[297] - z[82]*z[112]*z[299] - z[82]*z[286]*FxLHeel - 
  z[82]*z[286]*FxLToe - z[83]*z[113]*z[297] - z[83]*z[115]*z[299] - z[83]*
  z[287]*FxLHeel - z[83]*z[287]*FxLToe - z[84]*z[286]*FyLHeel - z[84]*z[286]*
  FyLToe - z[85]*z[287]*FyLHeel - z[85]*z[287]*FyLToe;
  z[374] = par->FootMass*(z[88]*z[99]+z[91]*z[95]+z[92]*z[302]+z[308]*z[100]);
  z[375] = par->FootMass*(z[88]*z[91]+z[92]*z[308]);
  z[376] = par->FootMass*(z[88]*z[90]+z[93]*z[308]-par->ShankLen*z[77]*z[92]-
  par->ShankLen*z[78]*z[91]);
  z[377] = par->FootMass*(par->FootCMx*z[308]-par->FootCMy*z[88]);
  z[378] = z[82]*z[88]*FxLHeel + z[82]*z[88]*FxLToe + z[83]*z[112]*FxLHeel + 
  z[83]*z[112]*FxLToe + z[83]*z[308]*FxLHeel + z[83]*z[308]*FxLToe + z[84]*
  z[88]*FyLHeel + z[84]*z[88]*FyLToe + z[84]*z[112]*z[313] + z[84]*z[112]*
  z[316] + z[85]*z[112]*FyLHeel + z[85]*z[112]*FyLToe + z[85]*z[113]*z[313] + 
  z[85]*z[115]*z[316] + z[85]*z[308]*FyLHeel + z[85]*z[308]*FyLToe + z[113]*
  z[301]*FxLHeel + z[113]*z[306]*FyLHeel + z[115]*z[301]*FxLToe + z[115]*
  z[306]*FyLToe - z[101]*(z[84]*z[88]+z[85]*z[91]+z[85]*z[308]+z[92]*z[306]) - 
  z[82]*z[112]*z[318] - z[82]*z[112]*z[320] - z[83]*z[113]*z[318] - z[83]*
  z[115]*z[320];
  z[379] = par->ContactFric*z[34]*z[106]*z[165]*(-1+2/(1+z[172])) + par->ContactFric*
  z[34]*z[106]*z[167]*(-1+2/(1+z[173])) + par->ContactFric*z[35]*z[107]*
  z[165]*(-1+2/(1+z[172])) + par->ContactFric*z[35]*z[109]*z[167]*(-1+2/(1+
  z[173])) - z[36]*z[106]*z[165] - z[36]*z[106]*z[167] - z[37]*z[107]*z[165] - 
  z[37]*z[109]*z[167];
  z[380] = par->ContactFric*z[34]*z[105]*z[165]*(-1+2/(1+z[172])) + par->ContactFric*
  z[34]*z[105]*z[167]*(-1+2/(1+z[173])) + par->ContactFric*z[35]*z[108]*
  z[165]*(-1+2/(1+z[172])) + par->ContactFric*z[35]*z[110]*z[167]*(-1+2/(1+
  z[173])) - z[36]*z[105]*z[165] - z[36]*z[105]*z[167] - z[37]*z[108]*z[165] - 
  z[37]*z[110]*z[167];
  z[381] = par->ShankCMy*z[17]*z[102] + z[34]*z[105]*FyRHeel + z[34]*z[105]*
  FyRToe + z[35]*z[108]*FyRHeel + z[35]*z[110]*FyRToe + z[36]*z[105]*z[199] + 
  z[36]*z[105]*z[202] + z[37]*z[108]*z[199] + z[37]*z[110]*z[202] + z[105]*
  z[180]*FxRHeel + z[105]*z[180]*FxRToe + z[108]*z[181]*FxRHeel + z[110]*
  z[181]*FxRToe - z[101]*(z[34]*z[42]+z[35]*z[45]) - z[34]*z[105]*z[204] - 
  z[34]*z[105]*z[206] - z[35]*z[108]*z[204] - z[35]*z[110]*z[206];
  z[382] = par->FootMass*(z[42]*z[224]-z[45]*z[226]) - par->ShankCMy*par->ShankMass*
  z[13]*z[16];
  z[383] = par->ShankCMy*z[20]*z[102] + z[36]*z[105]*z[240] + z[36]*z[105]*
  z[243] + z[37]*z[108]*z[240] + z[37]*z[110]*z[243] + z[105]*z[223]*FxRHeel + 
  z[105]*z[223]*FxRToe + z[105]*z[230]*FyRHeel + z[105]*z[230]*FyRToe + 
  z[108]*z[225]*FxRHeel + z[108]*z[231]*FyRHeel + z[110]*z[225]*FxRToe + 
  z[110]*z[231]*FyRToe - z[101]*(z[42]*z[230]+z[45]*z[231]) - z[34]*z[105]*
  z[245] - z[34]*z[105]*z[247] - z[35]*z[108]*z[245] - z[35]*z[110]*z[247];
  z[384] = par->FootMass*(z[42]*z[47]+z[45]*z[250]-par->ShankLen*z[29]*z[52]-
  par->ShankLen*z[30]*z[51]);
  z[385] = par->FootMass*par->ShankLen*(z[29]*z[45]+z[30]*z[42]);
  z[386] = par->FootMass*par->ShankLen*(par->FootCMx*z[29]-par->FootCMy*z[30]);
  z[387] = z[35]*z[105]*FxRHeel + z[35]*z[105]*FxRToe + z[36]*z[105]*z[261] + 
  z[36]*z[105]*z[264] + z[37]*z[105]*FyRHeel + z[37]*z[105]*FyRToe + z[37]*
  z[108]*z[261] + z[37]*z[110]*z[264] + z[108]*z[249]*FxRHeel + z[108]*z[253]*
  FyRHeel + z[110]*z[249]*FxRToe + z[110]*z[253]*FyRToe - z[101]*(z[37]*z[42]+
  z[45]*z[253]-par->ShankLen*z[29]*z[37]-par->ShankLen*z[30]*z[36]) - z[34]*
  z[105]*z[266] - z[34]*z[105]*z[268] - z[35]*z[108]*z[266] - z[35]*z[110]*
  z[268] - par->ShankLen*z[29]*z[35]*FxRHeel - par->ShankLen*z[29]*z[35]*
  FxRToe - par->ShankLen*z[29]*z[37]*FyRHeel - par->ShankLen*z[29]*z[37]*
  FyRToe - par->ShankLen*z[30]*z[34]*FxRHeel - par->ShankLen*z[30]*z[34]*
  FxRToe - par->ShankLen*z[30]*z[36]*FyRHeel - par->ShankLen*z[30]*z[36]*
  FyRToe;
  z[388] = par->ContactY*z[36]*z[165] + par->ContactY*z[36]*z[167] + par->ContactFric*
  par->ContactHeelX*z[35]*z[165]*(-1+2/(1+z[172])) + par->ContactFric*par->ContactToeX*
  z[35]*z[167]*(-1+2/(1+z[173])) - par->ContactHeelX*z[37]*z[165] - par->ContactToeX*
  z[37]*z[167] - par->ContactFric*par->ContactY*z[34]*z[165]*(-1+2/(1+z[172])) - 
  par->ContactFric*par->ContactY*z[34]*z[167]*(-1+2/(1+z[173]));
  z[389] = par->ContactHeelX*z[35]*FyRHeel + par->ContactHeelX*z[37]*z[199] + 
  par->ContactHeelX*z[181]*FxRHeel + par->ContactToeX*z[35]*FyRToe + par->ContactToeX*
  z[37]*z[202] + par->ContactToeX*z[181]*FxRToe + par->ContactY*z[34]*z[204] + 
  par->ContactY*z[34]*z[206] - z[101]*(par->FootCMx*z[35]-par->FootCMy*z[34]) - 
  par->ContactHeelX*z[35]*z[204] - par->ContactToeX*z[35]*z[206] - par->ContactY*
  z[34]*FyRHeel - par->ContactY*z[34]*FyRToe - par->ContactY*z[36]*z[199] - 
  par->ContactY*z[36]*z[202] - par->ContactY*z[180]*FxRHeel - par->ContactY*
  z[180]*FxRToe;
  z[390] = par->FootMass*(par->FootCMx*z[226]+par->FootCMy*z[224]);
  z[391] = par->ContactHeelX*z[37]*z[240] + par->ContactHeelX*z[225]*FxRHeel + 
  par->ContactHeelX*z[231]*FyRHeel + par->ContactToeX*z[37]*z[243] + par->ContactToeX*
  z[225]*FxRToe + par->ContactToeX*z[231]*FyRToe + par->ContactY*z[34]*z[245] + 
  par->ContactY*z[34]*z[247] - z[101]*(par->FootCMx*z[231]-par->FootCMy*
  z[230]) - par->ContactHeelX*z[35]*z[245] - par->ContactToeX*z[35]*z[247] - 
  par->ContactY*z[36]*z[240] - par->ContactY*z[36]*z[243] - par->ContactY*
  z[223]*FxRHeel - par->ContactY*z[223]*FxRToe - par->ContactY*z[230]*FyRHeel - 
  par->ContactY*z[230]*FyRToe;
  z[392] = par->FootMass*(par->FootCMx*z[250]-par->FootCMy*z[47]);
  z[393] = par->ContactHeelX*z[37]*z[261] + par->ContactHeelX*z[249]*FxRHeel + 
  par->ContactHeelX*z[253]*FyRHeel + par->ContactToeX*z[37]*z[264] + par->ContactToeX*
  z[249]*FxRToe + par->ContactToeX*z[253]*FyRToe + par->ContactY*z[34]*z[266] + 
  par->ContactY*z[34]*z[268] - z[101]*(par->FootCMx*z[253]-par->FootCMy*z[37]) - 
  par->ContactHeelX*z[35]*z[266] - par->ContactToeX*z[35]*z[268] - par->ContactY*
  z[35]*FxRHeel - par->ContactY*z[35]*FxRToe - par->ContactY*z[36]*z[261] - 
  par->ContactY*z[36]*z[264] - par->ContactY*z[37]*FyRHeel - par->ContactY*
  z[37]*FyRToe;
  z[394] = par->ContactFric*z[82]*z[112]*z[169]*(-1+2/(1+z[174])) + par->ContactFric*
  z[82]*z[112]*z[171]*(-1+2/(1+z[175])) + par->ContactFric*z[83]*z[113]*
  z[169]*(-1+2/(1+z[174])) + par->ContactFric*z[83]*z[115]*z[171]*(-1+2/(1+
  z[175])) - z[84]*z[112]*z[169] - z[84]*z[112]*z[171] - z[85]*z[113]*z[169] - 
  z[85]*z[115]*z[171];
  z[395] = par->ContactFric*z[82]*z[111]*z[169]*(-1+2/(1+z[174])) + par->ContactFric*
  z[82]*z[111]*z[171]*(-1+2/(1+z[175])) + par->ContactFric*z[83]*z[114]*
  z[169]*(-1+2/(1+z[174])) + par->ContactFric*z[83]*z[116]*z[171]*(-1+2/(1+
  z[175])) - z[84]*z[111]*z[169] - z[84]*z[111]*z[171] - z[85]*z[114]*z[169] - 
  z[85]*z[116]*z[171];
  z[396] = par->ShankCMy*z[65]*z[102] + z[82]*z[111]*FyLHeel + z[82]*z[111]*
  FyLToe + z[83]*z[114]*FyLHeel + z[83]*z[116]*FyLToe + z[84]*z[111]*z[209] + 
  z[84]*z[111]*z[212] + z[85]*z[114]*z[209] + z[85]*z[116]*z[212] + z[111]*
  z[185]*FxLHeel + z[111]*z[185]*FxLToe + z[114]*z[186]*FxLHeel + z[116]*
  z[186]*FxLToe - z[101]*(z[82]*z[90]+z[83]*z[93]) - z[82]*z[111]*z[214] - 
  z[82]*z[111]*z[216] - z[83]*z[114]*z[214] - z[83]*z[116]*z[216];
  z[397] = par->FootMass*(z[90]*z[276]-z[93]*z[278]) - par->ShankCMy*par->ShankMass*
  z[61]*z[64];
  z[398] = par->ShankCMy*z[68]*z[102] + z[84]*z[111]*z[292] + z[84]*z[111]*
  z[295] + z[85]*z[114]*z[292] + z[85]*z[116]*z[295] + z[111]*z[275]*FxLHeel + 
  z[111]*z[275]*FxLToe + z[111]*z[283]*FyLHeel + z[111]*z[283]*FyLToe + 
  z[114]*z[277]*FxLHeel + z[114]*z[284]*FyLHeel + z[116]*z[277]*FxLToe + 
  z[116]*z[284]*FyLToe - z[101]*(z[90]*z[283]+z[93]*z[284]) - z[82]*z[111]*
  z[297] - z[82]*z[111]*z[299] - z[83]*z[114]*z[297] - z[83]*z[116]*z[299];
  z[399] = par->FootMass*(z[90]*z[95]+z[93]*z[302]-par->ShankLen*z[77]*z[100]-
  par->ShankLen*z[78]*z[99]);
  z[400] = par->FootMass*par->ShankLen*(z[77]*z[93]+z[78]*z[90]);
  z[401] = par->FootMass*par->ShankLen*(par->FootCMx*z[77]-par->FootCMy*z[78]);
  z[402] = z[83]*z[111]*FxLHeel + z[83]*z[111]*FxLToe + z[84]*z[111]*z[313] + 
  z[84]*z[111]*z[316] + z[85]*z[111]*FyLHeel + z[85]*z[111]*FyLToe + z[85]*
  z[114]*z[313] + z[85]*z[116]*z[316] + z[114]*z[301]*FxLHeel + z[114]*z[306]*
  FyLHeel + z[116]*z[301]*FxLToe + z[116]*z[306]*FyLToe - z[101]*(z[85]*z[90]+
  z[93]*z[306]-par->ShankLen*z[77]*z[85]-par->ShankLen*z[78]*z[84]) - z[82]*
  z[111]*z[318] - z[82]*z[111]*z[320] - z[83]*z[114]*z[318] - z[83]*z[116]*
  z[320] - par->ShankLen*z[77]*z[83]*FxLHeel - par->ShankLen*z[77]*z[83]*
  FxLToe - par->ShankLen*z[77]*z[85]*FyLHeel - par->ShankLen*z[77]*z[85]*
  FyLToe - par->ShankLen*z[78]*z[82]*FxLHeel - par->ShankLen*z[78]*z[82]*
  FxLToe - par->ShankLen*z[78]*z[84]*FyLHeel - par->ShankLen*z[78]*z[84]*
  FyLToe;
  z[403] = par->ContactY*z[84]*z[169] + par->ContactY*z[84]*z[171] + par->ContactFric*
  par->ContactHeelX*z[83]*z[169]*(-1+2/(1+z[174])) + par->ContactFric*par->ContactToeX*
  z[83]*z[171]*(-1+2/(1+z[175])) - par->ContactHeelX*z[85]*z[169] - par->ContactToeX*
  z[85]*z[171] - par->ContactFric*par->ContactY*z[82]*z[169]*(-1+2/(1+z[174])) - 
  par->ContactFric*par->ContactY*z[82]*z[171]*(-1+2/(1+z[175]));
  z[404] = par->ContactHeelX*z[83]*FyLHeel + par->ContactHeelX*z[85]*z[209] + 
  par->ContactHeelX*z[186]*FxLHeel + par->ContactToeX*z[83]*FyLToe + par->ContactToeX*
  z[85]*z[212] + par->ContactToeX*z[186]*FxLToe + par->ContactY*z[82]*z[214] + 
  par->ContactY*z[82]*z[216] - z[101]*(par->FootCMx*z[83]-par->FootCMy*z[82]) - 
  par->ContactHeelX*z[83]*z[214] - par->ContactToeX*z[83]*z[216] - par->ContactY*
  z[82]*FyLHeel - par->ContactY*z[82]*FyLToe - par->ContactY*z[84]*z[209] - 
  par->ContactY*z[84]*z[212] - par->ContactY*z[185]*FxLHeel - par->ContactY*
  z[185]*FxLToe;
  z[405] = par->FootMass*(par->FootCMx*z[278]+par->FootCMy*z[276]);
  z[406] = par->ContactHeelX*z[85]*z[292] + par->ContactHeelX*z[277]*FxLHeel + 
  par->ContactHeelX*z[284]*FyLHeel + par->ContactToeX*z[85]*z[295] + par->ContactToeX*
  z[277]*FxLToe + par->ContactToeX*z[284]*FyLToe + par->ContactY*z[82]*z[297] + 
  par->ContactY*z[82]*z[299] - z[101]*(par->FootCMx*z[284]-par->FootCMy*
  z[283]) - par->ContactHeelX*z[83]*z[297] - par->ContactToeX*z[83]*z[299] - 
  par->ContactY*z[84]*z[292] - par->ContactY*z[84]*z[295] - par->ContactY*
  z[275]*FxLHeel - par->ContactY*z[275]*FxLToe - par->ContactY*z[283]*FyLHeel - 
  par->ContactY*z[283]*FyLToe;
  z[407] = par->FootMass*(par->FootCMx*z[302]-par->FootCMy*z[95]);
  z[408] = par->ContactHeelX*z[85]*z[313] + par->ContactHeelX*z[301]*FxLHeel + 
  par->ContactHeelX*z[306]*FyLHeel + par->ContactToeX*z[85]*z[316] + par->ContactToeX*
  z[301]*FxLToe + par->ContactToeX*z[306]*FyLToe + par->ContactY*z[82]*z[318] + 
  par->ContactY*z[82]*z[320] - z[101]*(par->FootCMx*z[306]-par->FootCMy*z[85]) - 
  par->ContactHeelX*z[83]*z[318] - par->ContactToeX*z[83]*z[320] - par->ContactY*
  z[83]*FxLHeel - par->ContactY*z[83]*FxLToe - par->ContactY*z[84]*z[313] - 
  par->ContactY*z[84]*z[316] - par->ContactY*z[85]*FyLHeel - par->ContactY*
  z[85]*FyLToe;
  z[409] = z[34]*z[36] + z[35]*z[37];
  z[410] = par->ContactDamp*z[409]*(yRHeel-par->ContactStiff*pow(dRHeel,3));
  z[411] = par->ContactDamp*z[409]*(yRToe-par->ContactStiff*pow(dRToe,3));
  z[412] = par->ContactFric*(z[410]*(-1+2/(1+z[172]))+2*(pow(z[34],2)+pow(
  z[35],2))*FyRHeel*z[172]/(par->ContactV0*pow((1+z[172]),2)));
  z[413] = par->ContactFric*(z[411]*(-1+2/(1+z[173]))+2*(pow(z[34],2)+pow(
  z[35],2))*FyRToe*z[173]/(par->ContactV0*pow((1+z[173]),2)));
  z[414] = z[82]*z[84] + z[83]*z[85];
  z[415] = par->ContactDamp*z[414]*(yLHeel-par->ContactStiff*pow(dLHeel,3));
  z[416] = par->ContactDamp*z[414]*(yLToe-par->ContactStiff*pow(dLToe,3));
  z[417] = par->ContactFric*(z[415]*(-1+2/(1+z[174]))+2*(pow(z[82],2)+pow(
  z[83],2))*FyLHeel*z[174]/(par->ContactV0*pow((1+z[174]),2)));
  z[418] = par->ContactFric*(z[416]*(-1+2/(1+z[175]))+2*(pow(z[82],2)+pow(
  z[83],2))*FyLToe*z[175]/(par->ContactV0*pow((1+z[175]),2)));
  z[419] = z[34]*z[36]*z[410] + z[34]*z[36]*z[411] + z[35]*z[37]*z[410] + 
  z[35]*z[37]*z[411] + z[82]*z[84]*z[415] + z[82]*z[84]*z[416] + z[83]*z[85]*
  z[415] + z[83]*z[85]*z[416] - pow(z[34],2)*z[412] - pow(z[34],2)*z[413] - 
  pow(z[35],2)*z[412] - pow(z[35],2)*z[413] - pow(z[82],2)*z[417] - pow(z[82],
  2)*z[418] - pow(z[83],2)*z[417] - pow(z[83],2)*z[418];
  z[420] = par->ContactDamp*(pow(z[36],2)+pow(z[37],2))*(yRHeel-par->ContactStiff*
  pow(dRHeel,3));
  z[421] = par->ContactDamp*(pow(z[36],2)+pow(z[37],2))*(yRToe-par->ContactStiff*
  pow(dRToe,3));
  z[422] = par->ContactFric*(z[420]*(-1+2/(1+z[172]))+2*z[409]*FyRHeel*z[172]/(
  par->ContactV0*pow((1+z[172]),2)));
  z[423] = par->ContactFric*(z[421]*(-1+2/(1+z[173]))+2*z[409]*FyRToe*z[173]/(
  par->ContactV0*pow((1+z[173]),2)));
  z[424] = par->ContactDamp*(pow(z[84],2)+pow(z[85],2))*(yLHeel-par->ContactStiff*
  pow(dLHeel,3));
  z[425] = par->ContactDamp*(pow(z[84],2)+pow(z[85],2))*(yLToe-par->ContactStiff*
  pow(dLToe,3));
  z[426] = par->ContactFric*(z[424]*(-1+2/(1+z[174]))+2*z[414]*FyLHeel*z[174]/(
  par->ContactV0*pow((1+z[174]),2)));
  z[427] = par->ContactFric*(z[425]*(-1+2/(1+z[175]))+2*z[414]*FyLToe*z[175]/(
  par->ContactV0*pow((1+z[175]),2)));
  z[428] = z[34]*z[36]*z[420] + z[34]*z[36]*z[421] + z[35]*z[37]*z[420] + 
  z[35]*z[37]*z[421] + z[82]*z[84]*z[424] + z[82]*z[84]*z[425] + z[83]*z[85]*
  z[424] + z[83]*z[85]*z[425] - pow(z[34],2)*z[422] - pow(z[34],2)*z[423] - 
  pow(z[35],2)*z[422] - pow(z[35],2)*z[423] - pow(z[82],2)*z[426] - pow(z[82],
  2)*z[427] - pow(z[83],2)*z[426] - pow(z[83],2)*z[427];
  z[429] = z[14]*(z[15]+par->ThighLen*z[11]);
  z[430] = z[13]*(z[15]+par->ThighLen*z[11]);
  z[431] = z[32] + z[430] + par->ShankLen*z[27];
  z[432] = z[29]*z[429] + z[30]*z[431];
  z[433] = z[432] - z[48] - par->FootCMx*z[50];
  z[434] = z[29]*z[431] - z[30]*z[429];
  z[435] = z[434] - z[49] - par->FootCMy*z[50];
  z[436] = z[62]*(z[63]+par->ThighLen*z[59]);
  z[437] = z[61]*(z[63]+par->ThighLen*z[59]);
  z[438] = z[80] + z[437] + par->ShankLen*z[75];
  z[439] = z[77]*z[436] + z[78]*z[438];
  z[440] = z[439] - z[96] - par->FootCMx*z[98];
  z[441] = z[77]*z[438] - z[78]*z[436];
  z[442] = z[441] - z[97] - par->FootCMy*z[98];
  z[443] = z[430] - z[26] - par->ShankCMy*z[27];
  z[444] = z[437] - z[74] - par->ShankCMy*z[75];
  z[445] = par->FootMass*(z[34]*z[433]+z[35]*z[435]) + par->FootMass*(z[82]*
  z[440]+z[83]*z[442]) + par->ShankMass*(z[17]*z[429]+z[18]*z[443]) + par->ShankMass*(
  z[65]*z[436]+z[66]*z[444]) + par->TrunkMass*z[2]*(par->TrunkCMy*q3p+z[3]) - 
  par->ThighMass*z[8]*(z[10]+par->ThighCMy*z[11]) - par->ThighMass*z[56]*(
  z[58]+par->ThighCMy*z[59]);
  z[446] = z[36]*z[106] + z[37]*z[107];
  z[447] = par->ContactDamp*z[446]*(yRHeel-par->ContactStiff*pow(dRHeel,3));
  z[448] = z[36]*z[106] + z[37]*z[109];
  z[449] = par->ContactDamp*z[448]*(yRToe-par->ContactStiff*pow(dRToe,3));
  z[450] = z[34]*z[106] + z[35]*z[107];
  z[451] = par->ContactFric*(z[447]*(-1+2/(1+z[172]))+2*z[450]*FyRHeel*z[172]/(
  par->ContactV0*pow((1+z[172]),2)));
  z[452] = z[34]*z[106] + z[35]*z[109];
  z[453] = par->ContactFric*(z[449]*(-1+2/(1+z[173]))+2*z[452]*FyRToe*z[173]/(
  par->ContactV0*pow((1+z[173]),2)));
  z[454] = z[84]*z[112] + z[85]*z[113];
  z[455] = par->ContactDamp*z[454]*(yLHeel-par->ContactStiff*pow(dLHeel,3));
  z[456] = z[84]*z[112] + z[85]*z[115];
  z[457] = par->ContactDamp*z[456]*(yLToe-par->ContactStiff*pow(dLToe,3));
  z[458] = z[82]*z[112] + z[83]*z[113];
  z[459] = par->ContactFric*(z[455]*(-1+2/(1+z[174]))+2*z[458]*FyLHeel*z[174]/(
  par->ContactV0*pow((1+z[174]),2)));
  z[460] = z[82]*z[112] + z[83]*z[115];
  z[461] = par->ContactFric*(z[457]*(-1+2/(1+z[175]))+2*z[460]*FyLToe*z[175]/(
  par->ContactV0*pow((1+z[175]),2)));
  z[462] = z[34]*z[36]*z[447] + z[34]*z[36]*z[449] + z[35]*z[37]*z[447] + 
  z[35]*z[37]*z[449] + z[82]*z[84]*z[455] + z[82]*z[84]*z[457] + z[83]*z[85]*
  z[455] + z[83]*z[85]*z[457] - pow(z[34],2)*z[451] - pow(z[34],2)*z[453] - 
  pow(z[35],2)*z[451] - pow(z[35],2)*z[453] - pow(z[82],2)*z[459] - pow(z[82],
  2)*z[461] - pow(z[83],2)*z[459] - pow(z[83],2)*z[461];
  z[463] = par->FootMass*(z[34]*z[433]+z[35]*z[435]) + par->ShankMass*(z[17]*
  z[429]+z[18]*z[443]) - par->ThighMass*z[8]*(z[10]+par->ThighCMy*z[11]);
  z[464] = z[34]*z[36]*z[447] + z[34]*z[36]*z[449] + z[35]*z[37]*z[447] + 
  z[35]*z[37]*z[449] - pow(z[34],2)*z[451] - pow(z[34],2)*z[453] - pow(z[35],
  2)*z[451] - pow(z[35],2)*z[453];
  z[465] = z[30]*(z[32]+par->ShankLen*z[27]);
  z[466] = z[465] - z[48] - par->FootCMx*z[50];
  z[467] = z[29]*(z[32]+par->ShankLen*z[27]);
  z[468] = z[467] - z[49] - par->FootCMy*z[50];
  z[469] = par->FootMass*(z[34]*z[466]+z[35]*z[468]) - par->ShankMass*z[18]*(
  z[26]+par->ShankCMy*z[27]);
  z[470] = z[36]*z[105] + z[37]*z[108];
  z[471] = par->ContactDamp*z[470]*(yRHeel-par->ContactStiff*pow(dRHeel,3));
  z[472] = z[36]*z[105] + z[37]*z[110];
  z[473] = par->ContactDamp*z[472]*(yRToe-par->ContactStiff*pow(dRToe,3));
  z[474] = z[34]*z[105] + z[35]*z[108];
  z[475] = par->ContactFric*(z[471]*(-1+2/(1+z[172]))+2*z[474]*FyRHeel*z[172]/(
  par->ContactV0*pow((1+z[172]),2)));
  z[476] = z[34]*z[105] + z[35]*z[110];
  z[477] = par->ContactFric*(z[473]*(-1+2/(1+z[173]))+2*z[476]*FyRToe*z[173]/(
  par->ContactV0*pow((1+z[173]),2)));
  z[478] = z[34]*z[36]*z[471] + z[34]*z[36]*z[473] + z[35]*z[37]*z[471] + 
  z[35]*z[37]*z[473] - pow(z[34],2)*z[475] - pow(z[34],2)*z[477] - pow(z[35],
  2)*z[475] - pow(z[35],2)*z[477];
  z[479] = par->FootMass*(z[34]*(z[48]+par->FootCMx*z[50])+z[35]*(z[49]+
  par->FootCMy*z[50]));
  z[480] = par->ContactHeelX*z[37] - par->ContactY*z[36];
  z[481] = par->ContactDamp*z[480]*(yRHeel-par->ContactStiff*pow(dRHeel,3));
  z[482] = par->ContactToeX*z[37] - par->ContactY*z[36];
  z[483] = par->ContactDamp*z[482]*(yRToe-par->ContactStiff*pow(dRToe,3));
  z[484] = par->ContactHeelX*z[35] - par->ContactY*z[34];
  z[485] = par->ContactFric*(z[481]*(-1+2/(1+z[172]))+2*z[484]*FyRHeel*z[172]/(
  par->ContactV0*pow((1+z[172]),2)));
  z[486] = par->ContactToeX*z[35] - par->ContactY*z[34];
  z[487] = par->ContactFric*(z[483]*(-1+2/(1+z[173]))+2*z[486]*FyRToe*z[173]/(
  par->ContactV0*pow((1+z[173]),2)));
  z[488] = z[34]*z[36]*z[481] + z[34]*z[36]*z[483] + z[35]*z[37]*z[481] + 
  z[35]*z[37]*z[483] - pow(z[34],2)*z[485] - pow(z[34],2)*z[487] - pow(z[35],
  2)*z[485] - pow(z[35],2)*z[487];
  z[489] = par->FootMass*(z[82]*z[440]+z[83]*z[442]) + par->ShankMass*(z[65]*
  z[436]+z[66]*z[444]) - par->ThighMass*z[56]*(z[58]+par->ThighCMy*z[59]);
  z[490] = z[82]*z[84]*z[455] + z[82]*z[84]*z[457] + z[83]*z[85]*z[455] + 
  z[83]*z[85]*z[457] - pow(z[82],2)*z[459] - pow(z[82],2)*z[461] - pow(z[83],
  2)*z[459] - pow(z[83],2)*z[461];
  z[491] = z[78]*(z[80]+par->ShankLen*z[75]);
  z[492] = z[491] - z[96] - par->FootCMx*z[98];
  z[493] = z[77]*(z[80]+par->ShankLen*z[75]);
  z[494] = z[493] - z[97] - par->FootCMy*z[98];
  z[495] = par->FootMass*(z[82]*z[492]+z[83]*z[494]) - par->ShankMass*z[66]*(
  z[74]+par->ShankCMy*z[75]);
  z[496] = z[84]*z[111] + z[85]*z[114];
  z[497] = par->ContactDamp*z[496]*(yLHeel-par->ContactStiff*pow(dLHeel,3));
  z[498] = z[84]*z[111] + z[85]*z[116];
  z[499] = par->ContactDamp*z[498]*(yLToe-par->ContactStiff*pow(dLToe,3));
  z[500] = z[82]*z[111] + z[83]*z[114];
  z[501] = par->ContactFric*(z[497]*(-1+2/(1+z[174]))+2*z[500]*FyLHeel*z[174]/(
  par->ContactV0*pow((1+z[174]),2)));
  z[502] = z[82]*z[111] + z[83]*z[116];
  z[503] = par->ContactFric*(z[499]*(-1+2/(1+z[175]))+2*z[502]*FyLToe*z[175]/(
  par->ContactV0*pow((1+z[175]),2)));
  z[504] = z[82]*z[84]*z[497] + z[82]*z[84]*z[499] + z[83]*z[85]*z[497] + 
  z[83]*z[85]*z[499] - pow(z[82],2)*z[501] - pow(z[82],2)*z[503] - pow(z[83],
  2)*z[501] - pow(z[83],2)*z[503];
  z[505] = par->FootMass*(z[82]*(z[96]+par->FootCMx*z[98])+z[83]*(z[97]+
  par->FootCMy*z[98]));
  z[506] = par->ContactHeelX*z[85] - par->ContactY*z[84];
  z[507] = par->ContactDamp*z[506]*(yLHeel-par->ContactStiff*pow(dLHeel,3));
  z[508] = par->ContactToeX*z[85] - par->ContactY*z[84];
  z[509] = par->ContactDamp*z[508]*(yLToe-par->ContactStiff*pow(dLToe,3));
  z[510] = par->ContactHeelX*z[83] - par->ContactY*z[82];
  z[511] = par->ContactFric*(z[507]*(-1+2/(1+z[174]))+2*z[510]*FyLHeel*z[174]/(
  par->ContactV0*pow((1+z[174]),2)));
  z[512] = par->ContactToeX*z[83] - par->ContactY*z[82];
  z[513] = par->ContactFric*(z[509]*(-1+2/(1+z[175]))+2*z[512]*FyLToe*z[175]/(
  par->ContactV0*pow((1+z[175]),2)));
  z[514] = z[82]*z[84]*z[507] + z[82]*z[84]*z[509] + z[83]*z[85]*z[507] + 
  z[83]*z[85]*z[509] - pow(z[82],2)*z[511] - pow(z[82],2)*z[513] - pow(z[83],
  2)*z[511] - pow(z[83],2)*z[513];
  z[515] = z[410]*pow(z[36],2) + z[410]*pow(z[37],2) + z[411]*pow(z[36],2) + 
  z[411]*pow(z[37],2) + z[415]*pow(z[84],2) + z[415]*pow(z[85],2) + z[416]*
  pow(z[84],2) + z[416]*pow(z[85],2) - z[34]*z[36]*z[412] - z[34]*z[36]*
  z[413] - z[35]*z[37]*z[412] - z[35]*z[37]*z[413] - z[82]*z[84]*z[417] - 
  z[82]*z[84]*z[418] - z[83]*z[85]*z[417] - z[83]*z[85]*z[418];
  z[516] = z[420]*pow(z[36],2) + z[420]*pow(z[37],2) + z[421]*pow(z[36],2) + 
  z[421]*pow(z[37],2) + z[424]*pow(z[84],2) + z[424]*pow(z[85],2) + z[425]*
  pow(z[84],2) + z[425]*pow(z[85],2) - z[34]*z[36]*z[422] - z[34]*z[36]*
  z[423] - z[35]*z[37]*z[422] - z[35]*z[37]*z[423] - z[82]*z[84]*z[426] - 
  z[82]*z[84]*z[427] - z[83]*z[85]*z[426] - z[83]*z[85]*z[427];
  z[517] = par->FootMass*(z[36]*z[433]+z[37]*z[435]) + par->FootMass*(z[84]*
  z[440]+z[85]*z[442]) + par->ShankMass*(z[19]*z[429]+z[20]*z[443]) + par->ShankMass*(
  z[67]*z[436]+z[68]*z[444]) - par->ThighMass*z[7]*(z[10]+par->ThighCMy*z[11]) - 
  par->ThighMass*z[55]*(z[58]+par->ThighCMy*z[59]) - par->TrunkMass*z[1]*(
  par->TrunkCMy*q3p+z[3]);
  z[518] = z[447]*pow(z[36],2) + z[447]*pow(z[37],2) + z[449]*pow(z[36],2) + 
  z[449]*pow(z[37],2) + z[455]*pow(z[84],2) + z[455]*pow(z[85],2) + z[457]*
  pow(z[84],2) + z[457]*pow(z[85],2) - z[34]*z[36]*z[451] - z[34]*z[36]*
  z[453] - z[35]*z[37]*z[451] - z[35]*z[37]*z[453] - z[82]*z[84]*z[459] - 
  z[82]*z[84]*z[461] - z[83]*z[85]*z[459] - z[83]*z[85]*z[461];
  z[519] = par->FootMass*(z[36]*z[433]+z[37]*z[435]) + par->ShankMass*(z[19]*
  z[429]+z[20]*z[443]) - par->ThighMass*z[7]*(z[10]+par->ThighCMy*z[11]);
  z[520] = z[447]*pow(z[36],2) + z[447]*pow(z[37],2) + z[449]*pow(z[36],2) + 
  z[449]*pow(z[37],2) - z[34]*z[36]*z[451] - z[34]*z[36]*z[453] - z[35]*z[37]*
  z[451] - z[35]*z[37]*z[453];
  z[521] = par->FootMass*(z[36]*z[466]+z[37]*z[468]) - par->ShankMass*z[20]*(
  z[26]+par->ShankCMy*z[27]);
  z[522] = z[471]*pow(z[36],2) + z[471]*pow(z[37],2) + z[473]*pow(z[36],2) + 
  z[473]*pow(z[37],2) - z[34]*z[36]*z[475] - z[34]*z[36]*z[477] - z[35]*z[37]*
  z[475] - z[35]*z[37]*z[477];
  z[523] = par->FootMass*(z[36]*(z[48]+par->FootCMx*z[50])+z[37]*(z[49]+
  par->FootCMy*z[50]));
  z[524] = z[481]*pow(z[36],2) + z[481]*pow(z[37],2) + z[483]*pow(z[36],2) + 
  z[483]*pow(z[37],2) - z[34]*z[36]*z[485] - z[34]*z[36]*z[487] - z[35]*z[37]*
  z[485] - z[35]*z[37]*z[487];
  z[525] = par->FootMass*(z[84]*z[440]+z[85]*z[442]) + par->ShankMass*(z[67]*
  z[436]+z[68]*z[444]) - par->ThighMass*z[55]*(z[58]+par->ThighCMy*z[59]);
  z[526] = z[455]*pow(z[84],2) + z[455]*pow(z[85],2) + z[457]*pow(z[84],2) + 
  z[457]*pow(z[85],2) - z[82]*z[84]*z[459] - z[82]*z[84]*z[461] - z[83]*z[85]*
  z[459] - z[83]*z[85]*z[461];
  z[527] = par->FootMass*(z[84]*z[492]+z[85]*z[494]) - par->ShankMass*z[68]*(
  z[74]+par->ShankCMy*z[75]);
  z[528] = z[497]*pow(z[84],2) + z[497]*pow(z[85],2) + z[499]*pow(z[84],2) + 
  z[499]*pow(z[85],2) - z[82]*z[84]*z[501] - z[82]*z[84]*z[503] - z[83]*z[85]*
  z[501] - z[83]*z[85]*z[503];
  z[529] = par->FootMass*(z[84]*(z[96]+par->FootCMx*z[98])+z[85]*(z[97]+
  par->FootCMy*z[98]));
  z[530] = z[507]*pow(z[84],2) + z[507]*pow(z[85],2) + z[509]*pow(z[84],2) + 
  z[509]*pow(z[85],2) - z[82]*z[84]*z[511] - z[82]*z[84]*z[513] - z[83]*z[85]*
  z[511] - z[83]*z[85]*z[513];
  z[531] = z[36]*z[106]*z[410] + z[36]*z[106]*z[411] + z[37]*z[107]*z[410] + 
  z[37]*z[109]*z[411] + z[84]*z[112]*z[415] + z[84]*z[112]*z[416] + z[85]*
  z[113]*z[415] + z[85]*z[115]*z[416] - z[34]*z[106]*z[412] - z[34]*z[106]*
  z[413] - z[35]*z[107]*z[412] - z[35]*z[109]*z[413] - z[82]*z[112]*z[417] - 
  z[82]*z[112]*z[418] - z[83]*z[113]*z[417] - z[83]*z[115]*z[418];
  z[532] = z[36]*z[106]*z[420] + z[36]*z[106]*z[421] + z[37]*z[107]*z[420] + 
  z[37]*z[109]*z[421] + z[84]*z[112]*z[424] + z[84]*z[112]*z[425] + z[85]*
  z[113]*z[424] + z[85]*z[115]*z[425] - z[34]*z[106]*z[422] - z[34]*z[106]*
  z[423] - z[35]*z[107]*z[422] - z[35]*z[109]*z[423] - z[82]*z[112]*z[426] - 
  z[82]*z[112]*z[427] - z[83]*z[113]*z[426] - z[83]*z[115]*z[427];
  z[533] = par->FootMass*(z[43]*z[433]+z[44]*z[435]) + par->FootMass*(z[91]*
  z[440]+z[92]*z[442]) - par->ShankMass*(z[22]*z[443]-z[23]*z[429]) - par->ShankMass*(
  z[70]*z[444]-z[71]*z[436]);
  z[534] = z[36]*z[106]*z[447] + z[36]*z[106]*z[449] + z[37]*z[107]*z[447] + 
  z[37]*z[109]*z[449] + z[84]*z[112]*z[455] + z[84]*z[112]*z[457] + z[85]*
  z[113]*z[455] + z[85]*z[115]*z[457] - z[34]*z[106]*z[451] - z[34]*z[106]*
  z[453] - z[35]*z[107]*z[451] - z[35]*z[109]*z[453] - z[82]*z[112]*z[459] - 
  z[82]*z[112]*z[461] - z[83]*z[113]*z[459] - z[83]*z[115]*z[461];
  z[535] = par->FootMass*(z[43]*z[433]+z[44]*z[435]) - par->ShankMass*(z[22]*
  z[443]-z[23]*z[429]);
  z[536] = z[36]*z[106]*z[447] + z[36]*z[106]*z[449] + z[37]*z[107]*z[447] + 
  z[37]*z[109]*z[449] - z[34]*z[106]*z[451] - z[34]*z[106]*z[453] - z[35]*
  z[107]*z[451] - z[35]*z[109]*z[453];
  z[537] = par->FootMass*(z[43]*z[466]+z[44]*z[468]) + par->ShankMass*z[22]*(
  z[26]+par->ShankCMy*z[27]);
  z[538] = z[36]*z[106]*z[471] + z[36]*z[106]*z[473] + z[37]*z[107]*z[471] + 
  z[37]*z[109]*z[473] - z[34]*z[106]*z[475] - z[34]*z[106]*z[477] - z[35]*
  z[107]*z[475] - z[35]*z[109]*z[477];
  z[539] = par->FootMass*(z[43]*(z[48]+par->FootCMx*z[50])+z[44]*(z[49]+
  par->FootCMy*z[50]));
  z[540] = z[36]*z[106]*z[481] + z[36]*z[106]*z[483] + z[37]*z[107]*z[481] + 
  z[37]*z[109]*z[483] - z[34]*z[106]*z[485] - z[34]*z[106]*z[487] - z[35]*
  z[107]*z[485] - z[35]*z[109]*z[487];
  z[541] = par->FootMass*(z[91]*z[440]+z[92]*z[442]) - par->ShankMass*(z[70]*
  z[444]-z[71]*z[436]);
  z[542] = z[84]*z[112]*z[455] + z[84]*z[112]*z[457] + z[85]*z[113]*z[455] + 
  z[85]*z[115]*z[457] - z[82]*z[112]*z[459] - z[82]*z[112]*z[461] - z[83]*
  z[113]*z[459] - z[83]*z[115]*z[461];
  z[543] = par->FootMass*(z[91]*z[492]+z[92]*z[494]) + par->ShankMass*z[70]*(
  z[74]+par->ShankCMy*z[75]);
  z[544] = z[84]*z[112]*z[497] + z[84]*z[112]*z[499] + z[85]*z[113]*z[497] + 
  z[85]*z[115]*z[499] - z[82]*z[112]*z[501] - z[82]*z[112]*z[503] - z[83]*
  z[113]*z[501] - z[83]*z[115]*z[503];
  z[545] = par->FootMass*(z[91]*(z[96]+par->FootCMx*z[98])+z[92]*(z[97]+
  par->FootCMy*z[98]));
  z[546] = z[84]*z[112]*z[507] + z[84]*z[112]*z[509] + z[85]*z[113]*z[507] + 
  z[85]*z[115]*z[509] - z[82]*z[112]*z[511] - z[82]*z[112]*z[513] - z[83]*
  z[113]*z[511] - z[83]*z[115]*z[513];
  z[547] = z[36]*z[106]*z[410] + z[36]*z[106]*z[411] + z[37]*z[107]*z[410] + 
  z[37]*z[109]*z[411] - z[34]*z[106]*z[412] - z[34]*z[106]*z[413] - z[35]*
  z[107]*z[412] - z[35]*z[109]*z[413];
  z[548] = z[36]*z[106]*z[420] + z[36]*z[106]*z[421] + z[37]*z[107]*z[420] + 
  z[37]*z[109]*z[421] - z[34]*z[106]*z[422] - z[34]*z[106]*z[423] - z[35]*
  z[107]*z[422] - z[35]*z[109]*z[423];
  z[549] = z[36]*z[105]*z[410] + z[36]*z[105]*z[411] + z[37]*z[108]*z[410] + 
  z[37]*z[110]*z[411] - z[34]*z[105]*z[412] - z[34]*z[105]*z[413] - z[35]*
  z[108]*z[412] - z[35]*z[110]*z[413];
  z[550] = z[36]*z[105]*z[420] + z[36]*z[105]*z[421] + z[37]*z[108]*z[420] + 
  z[37]*z[110]*z[421] - z[34]*z[105]*z[422] - z[34]*z[105]*z[423] - z[35]*
  z[108]*z[422] - z[35]*z[110]*z[423];
  z[551] = par->FootMass*(z[42]*z[433]+z[45]*z[435]) - par->ShankCMy*par->ShankMass*
  z[429];
  z[552] = z[36]*z[105]*z[447] + z[36]*z[105]*z[449] + z[37]*z[108]*z[447] + 
  z[37]*z[110]*z[449] - z[34]*z[105]*z[451] - z[34]*z[105]*z[453] - z[35]*
  z[108]*z[451] - z[35]*z[110]*z[453];
  z[553] = par->FootMass*(z[42]*z[466]+z[45]*z[468]);
  z[554] = z[36]*z[105]*z[471] + z[36]*z[105]*z[473] + z[37]*z[108]*z[471] + 
  z[37]*z[110]*z[473] - z[34]*z[105]*z[475] - z[34]*z[105]*z[477] - z[35]*
  z[108]*z[475] - z[35]*z[110]*z[477];
  z[555] = par->FootMass*(z[42]*(z[48]+par->FootCMx*z[50])+z[45]*(z[49]+
  par->FootCMy*z[50]));
  z[556] = z[36]*z[105]*z[481] + z[36]*z[105]*z[483] + z[37]*z[108]*z[481] + 
  z[37]*z[110]*z[483] - z[34]*z[105]*z[485] - z[34]*z[105]*z[487] - z[35]*
  z[108]*z[485] - z[35]*z[110]*z[487];
  z[557] = par->ContactHeelX*z[37]*z[410] + par->ContactToeX*z[37]*z[411] + 
  par->ContactY*z[34]*z[412] + par->ContactY*z[34]*z[413] - par->ContactY*
  z[36]*z[410] - par->ContactY*z[36]*z[411] - par->ContactHeelX*z[35]*z[412] - 
  par->ContactToeX*z[35]*z[413];
  z[558] = par->ContactHeelX*z[37]*z[420] + par->ContactToeX*z[37]*z[421] + 
  par->ContactY*z[34]*z[422] + par->ContactY*z[34]*z[423] - par->ContactY*
  z[36]*z[420] - par->ContactY*z[36]*z[421] - par->ContactHeelX*z[35]*z[422] - 
  par->ContactToeX*z[35]*z[423];
  z[559] = par->FootMass*(par->FootCMx*z[435]-par->FootCMy*z[433]);
  z[560] = par->ContactHeelX*z[37]*z[447] + par->ContactToeX*z[37]*z[449] + 
  par->ContactY*z[34]*z[451] + par->ContactY*z[34]*z[453] - par->ContactY*
  z[36]*z[447] - par->ContactY*z[36]*z[449] - par->ContactHeelX*z[35]*z[451] - 
  par->ContactToeX*z[35]*z[453];
  z[561] = par->FootMass*(par->FootCMx*z[468]-par->FootCMy*z[466]);
  z[562] = par->ContactHeelX*z[37]*z[471] + par->ContactToeX*z[37]*z[473] + 
  par->ContactY*z[34]*z[475] + par->ContactY*z[34]*z[477] - par->ContactY*
  z[36]*z[471] - par->ContactY*z[36]*z[473] - par->ContactHeelX*z[35]*z[475] - 
  par->ContactToeX*z[35]*z[477];
  z[563] = par->FootMass*(par->FootCMx*z[49]-par->FootCMy*z[48]);
  z[564] = par->ContactHeelX*z[37]*z[481] + par->ContactToeX*z[37]*z[483] + 
  par->ContactY*z[34]*z[485] + par->ContactY*z[34]*z[487] - par->ContactY*
  z[36]*z[481] - par->ContactY*z[36]*z[483] - par->ContactHeelX*z[35]*z[485] - 
  par->ContactToeX*z[35]*z[487];
  z[565] = z[84]*z[112]*z[415] + z[84]*z[112]*z[416] + z[85]*z[113]*z[415] + 
  z[85]*z[115]*z[416] - z[82]*z[112]*z[417] - z[82]*z[112]*z[418] - z[83]*
  z[113]*z[417] - z[83]*z[115]*z[418];
  z[566] = z[84]*z[112]*z[424] + z[84]*z[112]*z[425] + z[85]*z[113]*z[424] + 
  z[85]*z[115]*z[425] - z[82]*z[112]*z[426] - z[82]*z[112]*z[427] - z[83]*
  z[113]*z[426] - z[83]*z[115]*z[427];
  z[567] = z[84]*z[111]*z[415] + z[84]*z[111]*z[416] + z[85]*z[114]*z[415] + 
  z[85]*z[116]*z[416] - z[82]*z[111]*z[417] - z[82]*z[111]*z[418] - z[83]*
  z[114]*z[417] - z[83]*z[116]*z[418];
  z[568] = z[84]*z[111]*z[424] + z[84]*z[111]*z[425] + z[85]*z[114]*z[424] + 
  z[85]*z[116]*z[425] - z[82]*z[111]*z[426] - z[82]*z[111]*z[427] - z[83]*
  z[114]*z[426] - z[83]*z[116]*z[427];
  z[569] = par->FootMass*(z[90]*z[440]+z[93]*z[442]) - par->ShankCMy*par->ShankMass*
  z[436];
  z[570] = z[84]*z[111]*z[455] + z[84]*z[111]*z[457] + z[85]*z[114]*z[455] + 
  z[85]*z[116]*z[457] - z[82]*z[111]*z[459] - z[82]*z[111]*z[461] - z[83]*
  z[114]*z[459] - z[83]*z[116]*z[461];
  z[571] = par->FootMass*(z[90]*z[492]+z[93]*z[494]);
  z[572] = z[84]*z[111]*z[497] + z[84]*z[111]*z[499] + z[85]*z[114]*z[497] + 
  z[85]*z[116]*z[499] - z[82]*z[111]*z[501] - z[82]*z[111]*z[503] - z[83]*
  z[114]*z[501] - z[83]*z[116]*z[503];
  z[573] = par->FootMass*(z[90]*(z[96]+par->FootCMx*z[98])+z[93]*(z[97]+
  par->FootCMy*z[98]));
  z[574] = z[84]*z[111]*z[507] + z[84]*z[111]*z[509] + z[85]*z[114]*z[507] + 
  z[85]*z[116]*z[509] - z[82]*z[111]*z[511] - z[82]*z[111]*z[513] - z[83]*
  z[114]*z[511] - z[83]*z[116]*z[513];
  z[575] = par->ContactHeelX*z[85]*z[415] + par->ContactToeX*z[85]*z[416] + 
  par->ContactY*z[82]*z[417] + par->ContactY*z[82]*z[418] - par->ContactY*
  z[84]*z[415] - par->ContactY*z[84]*z[416] - par->ContactHeelX*z[83]*z[417] - 
  par->ContactToeX*z[83]*z[418];
  z[576] = par->ContactHeelX*z[85]*z[424] + par->ContactToeX*z[85]*z[425] + 
  par->ContactY*z[82]*z[426] + par->ContactY*z[82]*z[427] - par->ContactY*
  z[84]*z[424] - par->ContactY*z[84]*z[425] - par->ContactHeelX*z[83]*z[426] - 
  par->ContactToeX*z[83]*z[427];
  z[577] = par->FootMass*(par->FootCMx*z[442]-par->FootCMy*z[440]);
  z[578] = par->ContactHeelX*z[85]*z[455] + par->ContactToeX*z[85]*z[457] + 
  par->ContactY*z[82]*z[459] + par->ContactY*z[82]*z[461] - par->ContactY*
  z[84]*z[455] - par->ContactY*z[84]*z[457] - par->ContactHeelX*z[83]*z[459] - 
  par->ContactToeX*z[83]*z[461];
  z[579] = par->FootMass*(par->FootCMx*z[494]-par->FootCMy*z[492]);
  z[580] = par->ContactHeelX*z[85]*z[497] + par->ContactToeX*z[85]*z[499] + 
  par->ContactY*z[82]*z[501] + par->ContactY*z[82]*z[503] - par->ContactY*
  z[84]*z[497] - par->ContactY*z[84]*z[499] - par->ContactHeelX*z[83]*z[501] - 
  par->ContactToeX*z[83]*z[503];
  z[581] = par->FootMass*(par->FootCMx*z[97]-par->FootCMy*z[96]);
  z[582] = par->ContactHeelX*z[85]*z[507] + par->ContactToeX*z[85]*z[509] + 
  par->ContactY*z[82]*z[511] + par->ContactY*z[82]*z[513] - par->ContactY*
  z[84]*z[507] - par->ContactY*z[84]*z[509] - par->ContactHeelX*z[83]*z[511] - 
  par->ContactToeX*z[83]*z[513];


  QQ[0] = z[135] + z[126]*q9pp + z[127]*q1pp + z[128]*q2pp + z[129]*q3pp + 
  z[130]*q7pp + z[131]*q8pp + z[132]*q6pp + z[133]*q4pp + z[134]*q5pp - 
  z[117];
  QQ[1] = z[144] + z[128]*q1pp + z[136]*q9pp + z[137]*q2pp + z[138]*q3pp + 
  z[139]*q7pp + z[140]*q8pp + z[141]*q6pp + z[142]*q4pp + z[143]*q5pp - 
  z[118];
  QQ[2] = z[152] + z[129]*q1pp + z[138]*q2pp + z[145]*q3pp + z[146]*q7pp + 
  z[147]*q8pp + z[148]*q9pp + z[149]*q4pp + z[150]*q5pp + z[151]*q6pp - 
  z[119];
  QQ[3] = z[153] + z[133]*q1pp + z[142]*q2pp + z[149]*q3pp + z[149]*q4pp + 
  z[150]*q5pp + z[151]*q6pp - z[120];
  QQ[4] = z[156] + z[134]*q1pp + z[143]*q2pp + z[150]*q3pp + z[150]*q4pp + 
  z[154]*q5pp + z[155]*q6pp - z[121];
  QQ[5] = z[158] + z[132]*q1pp + z[141]*q2pp + z[151]*q3pp + z[151]*q4pp + 
  z[155]*q5pp + z[157]*q6pp - z[122];
  QQ[6] = z[159] + z[130]*q1pp + z[139]*q2pp + z[146]*q3pp + z[146]*q7pp + 
  z[147]*q8pp + z[148]*q9pp - z[123];
  QQ[7] = z[162] + z[131]*q1pp + z[140]*q2pp + z[147]*q3pp + z[147]*q7pp + 
  z[160]*q8pp + z[161]*q9pp - z[124];
  QQ[8] = z[163] + z[126]*q1pp + z[136]*q2pp + z[148]*q3pp + z[148]*q7pp + 
  z[157]*q9pp + z[161]*q8pp - z[125];
  dQQ_dq[0] = 0;
  dQQ_dq[1] = -z[176];
  dQQ_dq[2] = z[187] + z[188]*q9pp + z[189]*q1pp + z[190]*q2pp + z[191]*
  q3pp + z[192]*q7pp + z[193]*q8pp + z[194]*q6pp + z[195]*q4pp + z[196]*q5pp - 
  z[217];
  dQQ_dq[3] = z[218] + z[194]*q6pp + z[195]*q3pp + z[195]*q4pp + z[196]*
  q5pp + z[219]*q1pp + z[220]*q2pp - z[221];
  dQQ_dq[4] = z[227] + z[228]*q1pp + z[232]*q2pp + z[235]*q3pp + z[235]*
  q4pp + z[236]*q6pp + z[237]*q5pp - z[248];
  dQQ_dq[5] = z[251] + z[254]*q2pp + z[256]*q3pp + z[256]*q4pp + z[257]*
  q6pp + z[258]*q5pp + 2*z[252]*q1pp - z[269];
  dQQ_dq[6] = z[270] + z[188]*q9pp + z[192]*q3pp + z[192]*q7pp + z[193]*
  q8pp + z[271]*q1pp + z[272]*q2pp - z[273];
  dQQ_dq[7] = z[279] + z[280]*q9pp + z[281]*q1pp + z[285]*q2pp + z[288]*
  q3pp + z[288]*q7pp + z[289]*q8pp - z[300];
  dQQ_dq[8] = z[303] + z[304]*q9pp + z[307]*q2pp + z[309]*q3pp + z[309]*
  q7pp + z[310]*q8pp + 2*z[305]*q1pp - z[321];
  dQQ_dq[9] = 0;
  dQQ_dq[10] = -z[322];
  dQQ_dq[11] = z[135] + z[126]*q9pp + z[129]*q3pp + z[130]*q7pp + z[131]*
  q8pp + z[132]*q6pp + z[133]*q4pp + z[134]*q5pp + z[190]*q1pp + z[323]*q2pp - 
  z[324];
  dQQ_dq[12] = z[325] + z[132]*q6pp + z[133]*q3pp + z[133]*q4pp + z[134]*
  q5pp + z[220]*q1pp + z[326]*q2pp - z[327];
  dQQ_dq[13] = z[328] + z[232]*q1pp + z[329]*q2pp + z[330]*q3pp + z[330]*
  q4pp + z[331]*q6pp + z[332]*q5pp - z[333];
  dQQ_dq[14] = z[334] + z[254]*q1pp + z[336]*q3pp + z[336]*q4pp + z[337]*
  q6pp + z[338]*q5pp + 2*z[335]*q2pp - z[339];
  dQQ_dq[15] = z[340] + z[126]*q9pp + z[130]*q3pp + z[130]*q7pp + z[131]*
  q8pp + z[272]*q1pp + z[341]*q2pp - z[342];
  dQQ_dq[16] = z[343] + z[285]*q1pp + z[344]*q9pp + z[345]*q2pp + z[346]*
  q3pp + z[346]*q7pp + z[347]*q8pp - z[348];
  dQQ_dq[17] = z[349] + z[307]*q1pp + z[350]*q9pp + z[352]*q3pp + z[352]*
  q7pp + z[353]*q8pp + 2*z[351]*q2pp - z[354];
  dQQ_dq[18] = 0;
  dQQ_dq[19] = -z[355];
  dQQ_dq[20] = z[129]*q2pp + z[191]*q1pp - z[356];
  dQQ_dq[21] = z[133]*q2pp + z[195]*q1pp - z[357];
  dQQ_dq[22] = z[358] + z[235]*q1pp + z[330]*q2pp + z[359]*q3pp + z[359]*
  q4pp + z[360]*q5pp - z[362] - z[361]*q6pp;
  dQQ_dq[23] = z[363] + z[256]*q1pp + z[336]*q2pp + z[365]*q5pp + z[366]*
  q6pp + 2*z[364]*q3pp + 2*z[364]*q4pp - z[367];
  dQQ_dq[24] = z[130]*q2pp + z[192]*q1pp - z[368];
  dQQ_dq[25] = z[369] + z[288]*q1pp + z[346]*q2pp + z[370]*q3pp + z[370]*
  q7pp + z[371]*q8pp - z[373] - z[372]*q9pp;
  dQQ_dq[26] = z[374] + z[309]*q1pp + z[352]*q2pp + z[376]*q8pp + z[377]*
  q9pp + 2*z[375]*q3pp + 2*z[375]*q7pp - z[378];
  dQQ_dq[27] = 0;
  dQQ_dq[28] = -z[379];
  dQQ_dq[29] = z[133]*q2pp + z[195]*q1pp - z[357];
  dQQ_dq[30] = z[133]*q2pp + z[195]*q1pp - z[357];
  dQQ_dq[31] = z[358] + z[235]*q1pp + z[330]*q2pp + z[359]*q3pp + z[359]*
  q4pp + z[360]*q5pp - z[362] - z[361]*q6pp;
  dQQ_dq[32] = z[363] + z[256]*q1pp + z[336]*q2pp + z[365]*q5pp + z[366]*
  q6pp + 2*z[364]*q3pp + 2*z[364]*q4pp - z[367];
  dQQ_dq[33] = 0;
  dQQ_dq[34] = 0;
  dQQ_dq[35] = 0;
  dQQ_dq[36] = 0;
  dQQ_dq[37] = -z[380];
  dQQ_dq[38] = z[134]*q2pp + z[196]*q1pp - z[381];
  dQQ_dq[39] = z[134]*q2pp + z[196]*q1pp - z[381];
  dQQ_dq[40] = z[382] + z[237]*q1pp + z[332]*q2pp + z[360]*q3pp + z[360]*
  q4pp - z[383];
  dQQ_dq[41] = z[384] + z[258]*q1pp + z[338]*q2pp + z[365]*q3pp + z[365]*
  q4pp - z[387] - 2*z[385]*q5pp - z[386]*q6pp;
  dQQ_dq[42] = 0;
  dQQ_dq[43] = 0;
  dQQ_dq[44] = 0;
  dQQ_dq[45] = 0;
  dQQ_dq[46] = -z[388];
  dQQ_dq[47] = z[132]*q2pp + z[194]*q1pp - z[389];
  dQQ_dq[48] = z[132]*q2pp + z[194]*q1pp - z[389];
  dQQ_dq[49] = z[236]*q1pp + z[331]*q2pp - z[390] - z[391] - z[361]*q3pp - 
  z[361]*q4pp;
  dQQ_dq[50] = z[392] + z[257]*q1pp + z[337]*q2pp + z[366]*q3pp + z[366]*
  q4pp - z[393] - z[386]*q5pp;
  dQQ_dq[51] = 0;
  dQQ_dq[52] = 0;
  dQQ_dq[53] = 0;
  dQQ_dq[54] = 0;
  dQQ_dq[55] = -z[394];
  dQQ_dq[56] = z[130]*q2pp + z[192]*q1pp - z[368];
  dQQ_dq[57] = 0;
  dQQ_dq[58] = 0;
  dQQ_dq[59] = 0;
  dQQ_dq[60] = z[130]*q2pp + z[192]*q1pp - z[368];
  dQQ_dq[61] = z[369] + z[288]*q1pp + z[346]*q2pp + z[370]*q3pp + z[370]*
  q7pp + z[371]*q8pp - z[373] - z[372]*q9pp;
  dQQ_dq[62] = z[374] + z[309]*q1pp + z[352]*q2pp + z[376]*q8pp + z[377]*
  q9pp + 2*z[375]*q3pp + 2*z[375]*q7pp - z[378];
  dQQ_dq[63] = 0;
  dQQ_dq[64] = -z[395];
  dQQ_dq[65] = z[131]*q2pp + z[193]*q1pp - z[396];
  dQQ_dq[66] = 0;
  dQQ_dq[67] = 0;
  dQQ_dq[68] = 0;
  dQQ_dq[69] = z[131]*q2pp + z[193]*q1pp - z[396];
  dQQ_dq[70] = z[397] + z[289]*q1pp + z[347]*q2pp + z[371]*q3pp + z[371]*
  q7pp - z[398];
  dQQ_dq[71] = z[399] + z[310]*q1pp + z[353]*q2pp + z[376]*q3pp + z[376]*
  q7pp - z[402] - 2*z[400]*q8pp - z[401]*q9pp;
  dQQ_dq[72] = 0;
  dQQ_dq[73] = -z[403];
  dQQ_dq[74] = z[126]*q2pp + z[188]*q1pp - z[404];
  dQQ_dq[75] = 0;
  dQQ_dq[76] = 0;
  dQQ_dq[77] = 0;
  dQQ_dq[78] = z[126]*q2pp + z[188]*q1pp - z[404];
  dQQ_dq[79] = z[280]*q1pp + z[344]*q2pp - z[405] - z[406] - z[372]*q3pp - 
  z[372]*q7pp;
  dQQ_dq[80] = z[407] + z[304]*q1pp + z[350]*q2pp + z[377]*q3pp + z[377]*
  q7pp - z[408] - z[401]*q8pp;
  dQQ_dqd[0] = -z[419];
  dQQ_dqd[1] = -z[428];
  dQQ_dqd[2] = z[445] - z[462];
  dQQ_dqd[3] = z[463] - z[464];
  dQQ_dqd[4] = z[469] - z[478];
  dQQ_dqd[5] = -z[479] - z[488];
  dQQ_dqd[6] = z[489] - z[490];
  dQQ_dqd[7] = z[495] - z[504];
  dQQ_dqd[8] = -z[505] - z[514];
  dQQ_dqd[9] = -z[515];
  dQQ_dqd[10] = -z[516];
  dQQ_dqd[11] = z[517] - z[518];
  dQQ_dqd[12] = z[519] - z[520];
  dQQ_dqd[13] = z[521] - z[522];
  dQQ_dqd[14] = -z[523] - z[524];
  dQQ_dqd[15] = z[525] - z[526];
  dQQ_dqd[16] = z[527] - z[528];
  dQQ_dqd[17] = -z[529] - z[530];
  dQQ_dqd[18] = -z[531];
  dQQ_dqd[19] = -z[532];
  dQQ_dqd[20] = z[533] - z[534];
  dQQ_dqd[21] = z[535] - z[536];
  dQQ_dqd[22] = z[537] - z[538];
  dQQ_dqd[23] = -z[539] - z[540];
  dQQ_dqd[24] = z[541] - z[542];
  dQQ_dqd[25] = z[543] - z[544];
  dQQ_dqd[26] = -z[545] - z[546];
  dQQ_dqd[27] = -z[547];
  dQQ_dqd[28] = -z[548];
  dQQ_dqd[29] = z[535] - z[536];
  dQQ_dqd[30] = z[535] - z[536];
  dQQ_dqd[31] = z[537] - z[538];
  dQQ_dqd[32] = -z[539] - z[540];
  dQQ_dqd[33] = 0;
  dQQ_dqd[34] = 0;
  dQQ_dqd[35] = 0;
  dQQ_dqd[36] = -z[549];
  dQQ_dqd[37] = -z[550];
  dQQ_dqd[38] = z[551] - z[552];
  dQQ_dqd[39] = z[551] - z[552];
  dQQ_dqd[40] = z[553] - z[554];
  dQQ_dqd[41] = -z[555] - z[556];
  dQQ_dqd[42] = 0;
  dQQ_dqd[43] = 0;
  dQQ_dqd[44] = 0;
  dQQ_dqd[45] = -z[557];
  dQQ_dqd[46] = -z[558];
  dQQ_dqd[47] = z[559] - z[560];
  dQQ_dqd[48] = z[559] - z[560];
  dQQ_dqd[49] = z[561] - z[562];
  dQQ_dqd[50] = -z[563] - z[564];
  dQQ_dqd[51] = 0;
  dQQ_dqd[52] = 0;
  dQQ_dqd[53] = 0;
  dQQ_dqd[54] = -z[565];
  dQQ_dqd[55] = -z[566];
  dQQ_dqd[56] = z[541] - z[542];
  dQQ_dqd[57] = 0;
  dQQ_dqd[58] = 0;
  dQQ_dqd[59] = 0;
  dQQ_dqd[60] = z[541] - z[542];
  dQQ_dqd[61] = z[543] - z[544];
  dQQ_dqd[62] = -z[545] - z[546];
  dQQ_dqd[63] = -z[567];
  dQQ_dqd[64] = -z[568];
  dQQ_dqd[65] = z[569] - z[570];
  dQQ_dqd[66] = 0;
  dQQ_dqd[67] = 0;
  dQQ_dqd[68] = 0;
  dQQ_dqd[69] = z[569] - z[570];
  dQQ_dqd[70] = z[571] - z[572];
  dQQ_dqd[71] = -z[573] - z[574];
  dQQ_dqd[72] = -z[575];
  dQQ_dqd[73] = -z[576];
  dQQ_dqd[74] = z[577] - z[578];
  dQQ_dqd[75] = 0;
  dQQ_dqd[76] = 0;
  dQQ_dqd[77] = 0;
  dQQ_dqd[78] = z[577] - z[578];
  dQQ_dqd[79] = z[579] - z[580];
  dQQ_dqd[80] = -z[581] - z[582];
  dQQ_dqdd[0] = z[127];
  dQQ_dqdd[1] = z[128];
  dQQ_dqdd[2] = z[129];
  dQQ_dqdd[3] = z[133];
  dQQ_dqdd[4] = z[134];
  dQQ_dqdd[5] = z[132];
  dQQ_dqdd[6] = z[130];
  dQQ_dqdd[7] = z[131];
  dQQ_dqdd[8] = z[126];
  dQQ_dqdd[9] = z[128];
  dQQ_dqdd[10] = z[137];
  dQQ_dqdd[11] = z[138];
  dQQ_dqdd[12] = z[142];
  dQQ_dqdd[13] = z[143];
  dQQ_dqdd[14] = z[141];
  dQQ_dqdd[15] = z[139];
  dQQ_dqdd[16] = z[140];
  dQQ_dqdd[17] = z[136];
  dQQ_dqdd[18] = z[129];
  dQQ_dqdd[19] = z[138];
  dQQ_dqdd[20] = z[145];
  dQQ_dqdd[21] = z[149];
  dQQ_dqdd[22] = z[150];
  dQQ_dqdd[23] = z[151];
  dQQ_dqdd[24] = z[146];
  dQQ_dqdd[25] = z[147];
  dQQ_dqdd[26] = z[148];
  dQQ_dqdd[27] = z[133];
  dQQ_dqdd[28] = z[142];
  dQQ_dqdd[29] = z[149];
  dQQ_dqdd[30] = z[149];
  dQQ_dqdd[31] = z[150];
  dQQ_dqdd[32] = z[151];
  dQQ_dqdd[33] = 0;
  dQQ_dqdd[34] = 0;
  dQQ_dqdd[35] = 0;
  dQQ_dqdd[36] = z[134];
  dQQ_dqdd[37] = z[143];
  dQQ_dqdd[38] = z[150];
  dQQ_dqdd[39] = z[150];
  dQQ_dqdd[40] = z[154];
  dQQ_dqdd[41] = z[155];
  dQQ_dqdd[42] = 0;
  dQQ_dqdd[43] = 0;
  dQQ_dqdd[44] = 0;
  dQQ_dqdd[45] = z[132];
  dQQ_dqdd[46] = z[141];
  dQQ_dqdd[47] = z[151];
  dQQ_dqdd[48] = z[151];
  dQQ_dqdd[49] = z[155];
  dQQ_dqdd[50] = z[157];
  dQQ_dqdd[51] = 0;
  dQQ_dqdd[52] = 0;
  dQQ_dqdd[53] = 0;
  dQQ_dqdd[54] = z[130];
  dQQ_dqdd[55] = z[139];
  dQQ_dqdd[56] = z[146];
  dQQ_dqdd[57] = 0;
  dQQ_dqdd[58] = 0;
  dQQ_dqdd[59] = 0;
  dQQ_dqdd[60] = z[146];
  dQQ_dqdd[61] = z[147];
  dQQ_dqdd[62] = z[148];
  dQQ_dqdd[63] = z[131];
  dQQ_dqdd[64] = z[140];
  dQQ_dqdd[65] = z[147];
  dQQ_dqdd[66] = 0;
  dQQ_dqdd[67] = 0;
  dQQ_dqdd[68] = 0;
  dQQ_dqdd[69] = z[147];
  dQQ_dqdd[70] = z[160];
  dQQ_dqdd[71] = z[161];
  dQQ_dqdd[72] = z[126];
  dQQ_dqdd[73] = z[136];
  dQQ_dqdd[74] = z[148];
  dQQ_dqdd[75] = 0;
  dQQ_dqdd[76] = 0;
  dQQ_dqdd[77] = 0;
  dQQ_dqdd[78] = z[148];
  dQQ_dqdd[79] = z[161];
  dQQ_dqdd[80] = z[157];
  grf[0] = FxRHeel + FxRToe;
  grf[1] = FyRHeel + FyRToe;
  grf[2] = q1*FyRHeel + q1*FyRToe + par->ContactHeelX*z[34]*FyRHeel + 
  par->ContactToeX*z[34]*FyRToe + par->ContactY*z[35]*FyRHeel + par->ContactY*
  z[35]*FyRToe + par->ShankLen*z[20]*FxRHeel + par->ShankLen*z[20]*FxRToe + 
  par->ThighLen*z[7]*FxRHeel + par->ThighLen*z[7]*FxRToe - q2*FxRHeel - q2*
  FxRToe - par->ContactHeelX*z[36]*FxRHeel - par->ContactToeX*z[36]*FxRToe - 
  par->ContactY*z[37]*FxRHeel - par->ContactY*z[37]*FxRToe - par->ShankLen*
  z[18]*FyRHeel - par->ShankLen*z[18]*FyRToe - par->ThighLen*z[8]*FyRHeel - 
  par->ThighLen*z[8]*FyRToe;
  grf[3] = FxLHeel + FxLToe;
  grf[4] = FyLHeel + FyLToe;
  grf[5] = q1*FyLHeel + q1*FyLToe + par->ContactHeelX*z[82]*FyLHeel + 
  par->ContactToeX*z[82]*FyLToe + par->ContactY*z[83]*FyLHeel + par->ContactY*
  z[83]*FyLToe + par->ShankLen*z[68]*FxLHeel + par->ShankLen*z[68]*FxLToe + 
  par->ThighLen*z[55]*FxLHeel + par->ThighLen*z[55]*FxLToe - q2*FxLHeel - q2*
  FxLToe - par->ContactHeelX*z[84]*FxLHeel - par->ContactToeX*z[84]*FxLToe - 
  par->ContactY*z[85]*FxLHeel - par->ContactY*z[85]*FxLToe - par->ShankLen*
  z[66]*FyLHeel - par->ShankLen*z[66]*FyLToe - par->ThighLen*z[56]*FyLHeel - 
  par->ThighLen*z[56]*FyLToe;
  stick[0] = q1 - par->TrunkCMy*z[2];
  stick[1] = q2 + par->TrunkCMy*z[1];
  stick[2] = q1;
  stick[3] = q2;
  stick[4] = q1 - par->ThighLen*z[8];
  stick[5] = q2 - par->ThighLen*z[7];
  stick[6] = q1 - par->ShankLen*z[18] - par->ThighLen*z[8];
  stick[7] = q2 - par->ShankLen*z[20] - par->ThighLen*z[7];
  stick[8] = q1 + par->ContactHeelX*z[34] + par->ContactY*z[35] - par->ShankLen*
  z[18] - par->ThighLen*z[8];
  stick[9] = q2 + par->ContactHeelX*z[36] + par->ContactY*z[37] - par->ShankLen*
  z[20] - par->ThighLen*z[7];
  stick[10] = q1 + par->ContactToeX*z[34] + par->ContactY*z[35] - par->ShankLen*
  z[18] - par->ThighLen*z[8];
  stick[11] = q2 + par->ContactToeX*z[36] + par->ContactY*z[37] - par->ShankLen*
  z[20] - par->ThighLen*z[7];
  stick[12] = q1 - par->ThighLen*z[56];
  stick[13] = q2 - par->ThighLen*z[55];
  stick[14] = q1 - par->ShankLen*z[66] - par->ThighLen*z[56];
  stick[15] = q2 - par->ShankLen*z[68] - par->ThighLen*z[55];
  stick[16] = q1 + par->ContactHeelX*z[82] + par->ContactY*z[83] - par->ShankLen*
  z[66] - par->ThighLen*z[56];
  stick[17] = q2 + par->ContactHeelX*z[84] + par->ContactY*z[85] - par->ShankLen*
  z[68] - par->ThighLen*z[55];
  stick[18] = q1 + par->ContactToeX*z[82] + par->ContactY*z[83] - par->ShankLen*
  z[66] - par->ThighLen*z[56];
  stick[19] = q2 + par->ContactToeX*z[84] + par->ContactY*z[85] - par->ShankLen*
  z[68] - par->ThighLen*z[55];

}
